{"version":3,"file":"js/app.82e491e9.js","mappings":"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","sources":["webpack://vue-project/./src/event.ts","webpack://vue-project/./src/game.ts","webpack://vue-project/./src/llm.ts","webpack://vue-project/./src/text.ts","webpack://vue-project/./src/components/CanvasUser.vue?4afb","webpack://vue-project/./src/components/CanvasUser.vue","webpack://vue-project/./src/components/CanvasUser.vue?7b96","webpack://vue-project/./src/components/GameCanvas.vue","webpack://vue-project/./src/components/GameCanvas.vue?d007","webpack://vue-project/./src/components/GameCanvas.vue?cf9f","webpack://vue-project/./src/components/MessageCard.vue?0f40","webpack://vue-project/./src/components/MessageCard.vue","webpack://vue-project/./src/components/MessageCard.vue?3d29","webpack://vue-project/./src/components/MessageList.vue?13dd","webpack://vue-project/./src/components/MessageList.vue","webpack://vue-project/./src/components/MessageList.vue?2e85","webpack://vue-project/./src/components/MessageFlow.vue?6cd4","webpack://vue-project/./src/components/MessageFlow.vue","webpack://vue-project/./src/components/MessageFlow.vue?8110","webpack://vue-project/./src/App.vue?2a5e","webpack://vue-project/./src/App.vue","webpack://vue-project/./src/App.vue?7ccd","webpack://vue-project/./src/main.ts","webpack://vue-project/webpack/bootstrap","webpack://vue-project/webpack/runtime/chunk loaded","webpack://vue-project/webpack/runtime/compat get default export","webpack://vue-project/webpack/runtime/define property getters","webpack://vue-project/webpack/runtime/global","webpack://vue-project/webpack/runtime/hasOwnProperty shorthand","webpack://vue-project/webpack/runtime/make namespace object","webpack://vue-project/webpack/runtime/jsonp chunk loading","webpack://vue-project/webpack/startup"],"sourcesContent":["const events:Record<string, Record<string, (...params:any[])=>void>> = {}\nexport function subscribe(event:string, action:(...params:any[])=>void):number\n{\n    if (!(event in events))\n    {\n        events[event] = {}\n    }\n    const key = Object.keys(events[event]).length-1;\n    events[event][key] = action;\n    return key;\n}\nexport function desubscribe(event:string, key:number):void\n{\n    if (event in events)\n    {\n        delete events[event][key];\n    }\n}\nexport function emit(event:string, ...args:any[]):void\n{\n    if (event in events)\n    {\n        Object.values(events[event]).forEach(action => {\n            action(...args);\n        });\n    }\n}","import { emit } from \"./event\";\n\nexport interface Message {id:number, a:number, i:number, j:number, v:number, t:number}\n\nexport interface Progress{\n  userMemory: Record<number, Array<number>>;\n  subjectiveUserGraph: Record<number, Record<string, number>>;\n  messages: Array<Message>;\n  userCount: number;\n  userType: Array<number>;\n  userLearnRate: Array<number>;\n  userFlowTags: Array<Array<number>>;\n  time: number;\n  score: number;\n}\n\nexport let debugMode = false;\n\nexport let progress:Progress = {\n  userMemory: {},\n  subjectiveUserGraph: {},\n  messages: [],\n  userType: [],\n  userLearnRate: [],\n  userCount: 0,\n  userFlowTags: [],\n  time: 0,\n  score: 0\n}\n\nexport function resetProgress()\n{\n  progress = {\n    userMemory: {},\n    subjectiveUserGraph: {},\n    messages: [],\n    userType: [],\n    userLearnRate: [],\n    userCount: 0,\n    userFlowTags: [],\n    time: 0,\n    score: 0\n  };\n  emit(\"resetProgress\");\n}\n\nexport function setProgress(newProgress:Progress)\n{\n  resetProgress();\n  progress = newProgress;\n  for(let i=0;i<progress.userCount;i++)\n  {\n    emit(\"createdUser\",i);\n  }\n  progress.messages.forEach(msg => {\n    emit('addedMessage', msg);\n  });\n}\n\nexport function getSubjectUserGraph(user:number):Record<string,number>\n{\n  if (!(user in progress.subjectiveUserGraph))\n  {\n    progress.subjectiveUserGraph[user] = {};\n  }\n  return progress.subjectiveUserGraph[user];\n}\n\nexport function rGetIn(a:number,b:number,graph:Record<string,number>):number\n{\n  if(a>b){\n    return rGetIn(b,a,graph);\n  }\n  const k = a.toString(32)+'_'+b.toString(32);\n  if (!(k in graph)) {\n    return 0;\n  }\n  return graph[k];\n}\n\nexport function rSetIn(a:number,b:number,v:number,graph:Record<string,number>)\n{\n  if(a>b) {\n    rSetIn(b,a,v,graph);\n    return;\n  }\n  const k = a.toString(32)+'_'+b.toString(32);\n  graph[k] = v;\n}\n\nexport function processPushTask(tasks:Array<number>,flow:number)\n{\n  for(let user=0;user<progress.userCount;user++)\n  {\n    if (progress.userType[user]!=0) continue;\n    const flowTags = progress.userFlowTags[user];\n    if (flow!=0&&(flowTags==undefined||!flowTags.includes(flow))) continue;\n    for(let i=0;i<tasks.length;i++){\n      pushMsgToUser(progress.messages[tasks[i]], user, tasks.length-i);\n    }\n  }\n}\n\nexport function createMessage(a:number, i:number, j:number, v:number)\n{\n  const msg = {id:progress.messages.length,a,i,j,v,t:progress.time};\n  progress.messages.push(msg);\n  emit('addedMessage', msg);\n}\n\nfunction changeAttitude(user:number, a:number, b:number, d:number):number\n{\n  const graph = getSubjectUserGraph(user);\n  const value=rGetIn(a,b,graph)+d;\n  rSetIn(a,b,value,graph);\n  if (Math.abs(d)>0.2)\n  {\n    createMessage(user,a,b,value);\n  }\n  return d;\n}\n\nfunction updateUser(user:number)\n{\n  console.log(`update ${user}`);\n  let maxIPD = 0;\n  let maxIPD_o = -1;\n  let maxIPD_x = -1;\n  const G = getSubjectUserGraph(user);\n  for(let o=0;o<progress.userCount;o++)\n  {\n    for(let x=0;x<progress.userCount;x++)\n    {\n      let IPD = instabilityPartialD(o,x,G);\n      if (o!=user) IPD *= (1-progress.userLearnRate[user]);\n      if (Math.abs(IPD) > Math.abs(maxIPD))\n      {\n        maxIPD = IPD;\n        maxIPD_o = o;\n        maxIPD_x = x;\n      }\n    }\n  }\n  if(maxIPD_o>=0)\n  {\n    const dAttitude = -Math.atan(maxIPD)/3.14;\n    console.log(`Dmax|dG(${maxIPD_o},${maxIPD_x})=${maxIPD},dAttitude=${dAttitude}`);\n    changeAttitude(user, maxIPD_o, maxIPD_x, dAttitude);\n  }\n}\n\nfunction instability(p:number)\n{\n  const G = getSubjectUserGraph(p);\n  let s = 0;\n  for(let x=0;x<progress.userCount;x++)\n  {\n    const Gpx = rGetIn(p,x,G);\n    for(let o=x;o<progress.userCount;o++)\n    {\n      const Gpo = rGetIn(p,o,G);\n      const Gox = rGetIn(o,x,G);\n      const i = Gpo*Gox-Gpx;\n      s+=i*i;\n    }\n  }\n  return s;\n}\n\n// function instabilityPartialD(p:number,o:number)\n// {\n//   const dGpo = 0.01;\n//   const pdir = instabilitydGpo(p,o,dGpo);\n//   const ndir = instabilitydGpo(p,o,-dGpo);\n//   return (pdir + ndir) * 0.5;\n// }\n\nfunction instabilityPartialD(p:number,o:number,G:Record<string,number>)\n{\n  let d = 0;\n  const Gpo = rGetIn(p,o,G);\n  for(let x=0;x<progress.userCount;x++)\n  {\n    const Gox = rGetIn(o,x,G);\n    const Gpx = rGetIn(p,x,G);\n    d+=Gox*(Gpo*Gox-Gpx);\n    d-=Gpx*Gox-Gpo;\n  }\n  const GooSub = rGetIn(o,o,G)-1;\n  d-=Gpo*GooSub*GooSub;\n  return d;\n}\n\nexport function pushMsgToUser(msg:Message, user:number, exposure:number)\n{\n  if(!(user in progress.userMemory))\n  {\n    progress.userMemory[user] = [];\n  }\n  progress.userMemory[user].push(msg.id);\n  const graph = getSubjectUserGraph(user);\n  const oldInstability = instability(user);\n  const ox = rGetIn(msg.i,msg.j,graph);\n  const lambda = progress.userLearnRate[user];\n  rSetIn(msg.i,msg.j,ox+lambda*rGetIn(user,msg.a,graph)*(msg.v-ox),graph);\n  const newInstability = instability(user);\n  const d = oldInstability - newInstability;\n  const views = Math.abs(d);\n  const likes = d>0?d:(Math.random()*Math.abs(d)*0.5);\n  emit('viewedMessage', msg.id, views);\n  emit('likedMessage', msg.id, likes);\n  emit('messageKnownExposure', msg.id, exposure);\n  emit('messageGainedScore', msg.id, Math.floor((views+likes)*exposure));\n}\n\nexport function updateUsers()\n{\n  for(let i=0;i<progress.userCount;i++)\n  {\n    if(progress.userType[i]!=0) continue;\n    updateUser(i);\n  }\n}\n\nexport function getRepulsion(i:number, j:number):boolean\n{\n    const rij=(a:number,b:number)=>Math.abs(rGetIn(a,b,getSubjectUserGraph(a)))<0.5;\n    let repulsion = rij(i,j);\n    if (!repulsion)\n    {\n        let innerRepulsion = false;\n        for(let d=1;d<j-i&&!innerRepulsion;d++)\n        {\n            innerRepulsion = !rij(i,i+d)&&!rij(i+d,j);\n        }\n        let outterRepulsion = false;\n        for(let d=1;d<i-j+progress.userCount&&!outterRepulsion;d++)\n        {\n            let o = j+d;\n            if (o >= progress.userCount)\n            {\n                o -= progress.userCount;\n            }\n            outterRepulsion = !rij(o,i)&&!rij(j,o);\n        }\n        repulsion = innerRepulsion && outterRepulsion;\n    }\n    return repulsion;\n}\n\nexport function createUser(type:number,learnRate:number=0.5)\n{\n    const id = progress.userCount;\n    progress.userCount += 1;\n    progress.userType.push(type);\n    progress.userLearnRate.push(learnRate);\n    emit(\"createdUser\",id);\n}\n\nexport function removeUser()\n{\n  progress.userCount -= 1;\n  progress.userType.pop();\n  emit(\"removedUser\");\n}\n\nexport default {}\n\nexport function executeCommand(cmd:string[])\n{\n  if (cmd[0]=='debug')\n  {\n    debugMode = !debugMode;\n  }\n}","import OpenAI from \"openai\"\n\nconst client = new OpenAI({\n    apiKey: \"sk-uFDUPAriuBg6l84rhrFxcRect2V0gpH59KVXj8dxG6wblr5p\",\n    baseURL: \"http://localhost:8080/llmapi\",\n    dangerouslyAllowBrowser: true\n})\n\nfunction delay(ms:number) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n}\n\nexport async function chat(msg:string)\n{\n    await delay(100);\n    return msg;\n    for (let attempt = 1; attempt <= 2; attempt++) {\n        try {\n            const completion = await client.chat.completions.create({\n                model: \"kimi-k2-turbo-preview\",\n                messages: [\n                    {\"role\": \"system\", \"content\": msg},\n                ],\n                temperature: 0.6,\n            })\n            return completion.choices[0].message.content??\"\";\n        }\n        catch (e)\n        {\n            await delay(5000);\n            console.error(e);\n        }\n    }\n    return \"\";\n}","import { emit } from \"./event\"\nimport { Message, progress } from \"./game\"\nimport { chat } from \"./llm\"\n\nexport interface UserText {\n    name:string,\n    prompt:string\n}\nexport interface MessageText {\n    title: string,\n    content: string,\n    minimumVersion: string\n}\n\nexport let text:{\n    userTexts:Array<UserText>,\n    messageTexts:Array<MessageText>,\n    generateQueue:Array<number>,\n    flowLabel:Array<string>\n}={\n    userTexts: [],\n    messageTexts: [],\n    generateQueue: [],\n    flowLabel: ['主推送流']\n}\n\nexport function loadText()\n{\n    const textSource = localStorage.getItem('text');\n    if (textSource != null)\n    {\n        text = JSON.parse(textSource);\n    }\n}\n\nexport function resetText()\n{\n    text = {\n        userTexts: [],\n        messageTexts: [],\n        generateQueue: [],\n        flowLabel: ['主推送流']\n    }\n}\n\nfunction getUserText(id:number):UserText\n{\n    if (id >= 0 && id < text.userTexts.length) return text.userTexts[id];\n    return {\n        name: '',\n        prompt: ''\n    }\n}\n\nexport function getUserName(id:number):string\n{\n    if (id<0 || id>=text.userTexts.length) return id.toString();\n    return text.userTexts[id].name\n}\n\nfunction getFullUserPrompt(id:number)\n{\n    // const basicPrompt = getUserText(id).prompt;\n    let historyContainer = \"\";\n    if (id in progress.userMemory && progress.userMemory[id].length>0)\n    {\n        historyContainer = `你需要参考的信息：[${progress.userMemory[id].filter(m=>m<text.messageTexts.length).map(m=>text.messageTexts[m].minimumVersion).join()}]。`;\n    }\n    return `${historyContainer}`;\n}\n\nconst traits:Array<string> = [\"神经质\",\"幽默\",\"严肃\"];\n\nfunction randomPick(arr:Array<string>):string\n{\n    return arr[Math.floor(Math.random()*traits.length)];\n}\n\nfunction getRelationshipDiffDescribe(relationship:number,other:string):string\n{\n    if (relationship > 0.5) return `对${other}的认同`;\n    if (relationship < 0.5) return `反对${other}`;\n    return `对社交媒体平台推送机制的反感`;\n}\nfunction getRelationshipDescribe(relationship:number):string\n{\n    if (relationship > 0.5) return \"认同\";\n    if (relationship < 0.5) return \"排斥\";\n    return \"不感兴趣\";\n}\n\nfunction getMessageContentPrompt(msg:Message):string\n{\n    return `扮演一名社交媒体用户虚构贴文。你的个性：${randomPick(traits)}。${getFullUserPrompt(msg.i)}要求1：长度1句话。要求2：站在${getUserText(msg.i).prompt}的视角表达你${getRelationshipDiffDescribe(msg.v,getUserText(msg.j).prompt)}。`;\n}\n\nfunction getMessageTitlePrompt(content:string):string\n{\n    return `[${content}]扮演作者，选择1个短语作为标题，不要出现任何标点符号。`;\n}\nfunction getMessageMinimumVersionPrompt(content:string):string\n{\n    return `[${content}]一句话总结这篇社媒博文。`;\n}\n\nlet generating = false;\n\nexport async function processGenerateQueue()\n{\n    if (generating || text.generateQueue == undefined || text.generateQueue.length==0) return;\n    const msg = text.generateQueue[0];\n    if (msg==undefined) return;\n    console.log(\"生成新消息\");\n    generating = true;\n    if (text.messageTexts.length - 1 < msg)\n    {\n        text.messageTexts.push({\n            title: \"\",\n            content: \"\",\n            minimumVersion: \"\"\n        });\n    }\n    // const content = await chat(getMessageContentPrompt(progress.messages[msg]));\n    // const title = await chat(getMessageTitlePrompt(content));\n    const msgObj = progress.messages[msg];\n    if(msgObj!=undefined)\n    {\n        let describe = '不感兴趣'\n        if (msgObj.v>0.5) describe='认同';\n        if (msgObj.v<-0.5) describe='反对';\n        const content = `${getUserName(msgObj.i)}对${getUserName(msgObj.j)}${describe}。`;\n        const title = \"消息\"+msg.toString();\n        const minimumVersion = await chat(getMessageMinimumVersionPrompt(content));\n        text.messageTexts[msg] = {title, content, minimumVersion}\n        localStorage.setItem('text', JSON.stringify(text));\n        emit(\"generatedMessage\", msg, title, content);\n        text.generateQueue.shift();\n    }\n    generating = false;\n    console.log(\"消息生成完毕\");\n}\n\nexport async function startGenerateMessage(msg:Message)\n{\n    if (text.generateQueue != undefined && (msg.id>=text.messageTexts.length || text.messageTexts[msg.id].title == ''))\n    {\n        text.generateQueue.push(msg.id);\n    }\n}\n\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, withCtx as _withCtx, createVNode as _createVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"username\" }\n\nimport { emit } from '@/event';\n\nimport { NBadge } from 'naive-ui';\nimport { getUserName } from '@/text';\nimport { progress } from '@/game';\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'CanvasUser',\n  props: {\n    id: {},\n    x: {},\n    y: {},\n    selected: { type: Boolean },\n    focused: { type: Boolean },\n    px: {},\n    py: {},\n    ps: {},\n    badgeDefault: {},\n    badgeInfo: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\nfunction onClick()\n{\n  emit('userPressed', props.id);\n}\nconst type=progress.userType[props.id];\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"canvas-user\",\n    style: _normalizeStyle({left: (__props.px + __props.x) * __props.ps - 20 + 'px', top: (__props.py + __props.y) * __props.ps - 20 + 'px', outline: (__props.selected?'2px':'1px') + ' solid '+ (__props.focused?'#ff0':'#000'), 'border-radius': ((_unref(type)==0)?50:0)+'%'}),\n    onClick: onClick\n  }, [\n    _createVNode(_unref(NBadge), {\n      value: __props.badgeDefault,\n      offset: [10,-5]\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_unref(NBadge), {\n          value: __props.badgeInfo,\n          type: 'info',\n          offset: [10,30]\n        }, {\n          default: _withCtx(() => [\n            _createElementVNode(\"div\", _hoisted_1, _toDisplayString(_unref(getUserName)(__props.id)), 1)\n          ]),\n          _: 1\n        }, 8, [\"value\"])\n      ]),\n      _: 1\n    }, 8, [\"value\"])\n  ], 4))\n}\n}\n\n})","<template>\n  <div class=\"canvas-user\" :style=\"{left: (px + x) * ps - 20 + 'px', top: (py + y) * ps - 20 + 'px', outline: (selected?'2px':'1px') + ' solid '+ (focused?'#ff0':'#000'), 'border-radius': ((type==0)?50:0)+'%'}\"\n  @click=\"onClick\"\n  >\n    <n-badge :value=\"badgeDefault\" :offset=\"[10,-5]\">\n    <n-badge :value=\"badgeInfo\" :type=\"'info'\" :offset=\"[10,30]\">\n    <div class=\"username\">{{ getUserName(id) }}</div>\n    </n-badge>\n    </n-badge>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { emit } from '@/event';\nimport { defineProps } from 'vue'\nimport { NBadge } from 'naive-ui';\nimport { getUserName } from '@/text';\nimport { progress } from '@/game';\nconst props = defineProps<{\n  id: number,\n  x: number,\n  y: number,\n  selected: boolean,\n  focused: boolean,\n  px: number,\n  py: number,\n  ps: number,\n  badgeDefault: number,\n  badgeInfo: number\n}>();\nfunction onClick()\n{\n  emit('userPressed', props.id);\n}\nconst type=progress.userType[props.id];\n</script>\n\n<style scoped>\n.canvas-user\n{\n  position: absolute;\n  outline: 1px solid #000;\n  background: #fff;\n  color: #000;\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  user-select: none;\n  -webkit-user-drag: none;\n  cursor: pointer;\n}\n.username\n{\n  margin: auto;\n  font-weight: bold;\n  text-wrap-mode: nowrap;\n}\n</style>","import script from \"./CanvasUser.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CanvasUser.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CanvasUser.vue?vue&type=style&index=0&id=3ecaf952&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3ecaf952\"]])\n\nexport default __exports__","<template>\n<div class=\"canvas\"\n:style=\"{'background-size': 20*s+'px '+20*s+'px', 'background-position': x*s+'px '+y*s+'px'}\">\n    <div class=\"mouse-input-handler\" @mousedown=\"onMousedown\" @mouseup=\"onMouseup\" @mousemove=\"onMousemove\" @touchstart=\"onTouchStart\" @touchend=\"onTouchEnd\" @touchmove=\"onTouchMove\" @wheel=\"onWheel\"></div>\n    <CanvasUser v-for=\"user in state.users\" :key=\"user.id\"\n    :id=\"user.id\" :x=\"user.x\" :y=\"user.y\" :px=\"x\" :py=\"y\" :ps=\"s\" :selected=\"state.selectedUsers.includes(user.id)\" :focused=\"state.focusedUser==user.id\"\n    :badge-default=\"((user.id in (appState?.uncollectedMessages??{}))?appState?.uncollectedMessages[user.id].length:0)??0\"\n    :badge-info=\"0\"\n    />\n    <canvas id=\"lines\"/>\n</div>\n</template>\n\n<script setup lang=\"ts\">\nimport { debugMode, getRepulsion, getSubjectUserGraph, progress, rGetIn } from '../game'\nimport { defineModel, onMounted, Ref, ref } from 'vue'\nimport CanvasUser from './CanvasUser.vue'\nimport { subscribe } from '../event'\nimport { AppState } from '@/App.vue';\ntype User = {\n    id: number;\n    x: number;\n    y: number;\n    vx: number;\n    vy: number;\n};\nconst state:Ref<{\n    users: Array<User>,\n    selectedUsers: Array<number>\n    focusedUser: number\n}> = ref({\n  users: [],\n  selectedUsers: [],\n  focusedUser: -1\n})\n\nsubscribe('resetProgress',()=>{\n    state.value = {\n        users: [],\n        selectedUsers: [],\n        focusedUser: -1\n    };\n})\n\nconst appState = defineModel<AppState>();\n\nconst x = ref(0);\nconst y = ref(0);\nconst s = ref(1);\nsubscribe('userPressed', (id)=>\n{\n    if (appState.value?.mode == 'user-edit') return;\n    let selectedUsers = state.value.selectedUsers;\n    if (selectedUsers.includes(id))\n    {\n        if (state.value.focusedUser != id)\n        {\n            state.value.focusedUser = id;\n        }\n        else\n        {\n            state.value.selectedUsers = selectedUsers.filter(i=>i!=id);\n            state.value.focusedUser = -1;\n        }\n    }\n    else{\n        state.value.focusedUser = id;\n        selectedUsers.push(id);\n    }\n})\n\nlet multiSelecting = false;\nlet multiSelectStartX = 0;\nlet multiSelectStartY = 0;\nlet mouseX = 0;\nlet mouseY = 0;\nlet touchStartX = 0;\nlet touchStartY = 0;\nlet touchStartCanvasX = 0;\nlet touchStartCanvasY = 0;\nlet touchesDistance = -1;\n\nfunction onTouchStart(e: TouchEvent)\n{\n    e.preventDefault();\n    if (e.touches.length == 1)\n    {\n        const touch = e.touches[0];\n        touchStartX = touch.clientX;\n        touchStartY = touch.clientY;\n        touchStartCanvasX = x.value;\n        touchStartCanvasY = y.value;\n    }\n}\n\nfunction onTouchEnd(e: TouchEvent)\n{\n    e.preventDefault();\n    if (e.touches.length == 0)\n    {\n        touchesDistance = -1;\n    }\n}\n\nfunction onTouchMove(e: TouchEvent)\n{\n    e.preventDefault();\n    if (e.touches.length == 1 && touchesDistance == -1)\n    {\n        const touch = e.touches[0];\n        mouseX = touch.clientX;\n        mouseY = touch.clientY;\n        x.value = mouseX - touchStartX + touchStartCanvasX;\n        y.value = mouseY - touchStartY + touchStartCanvasY;\n    }\n    else if (e.touches.length == 2)\n    {\n        const x1 = e.touches[0].clientX;\n        const y1 = e.touches[0].clientY;\n        const x2 = e.touches[1].clientX;\n        const y2 = e.touches[1].clientY;\n        const d = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n        if (touchesDistance>0)\n        {\n            let delta = (d - touchesDistance) * 0.01;\n            if (delta < -1)\n            {\n                delta = -1;\n            }\n            if (delta > 1)\n            {\n                delta = 1;\n            }\n            delta += 1;\n            // if (delta < 0)\n            // {\n            //     delta += 1;\n            // }\n            changeScale((x1+x2)/2, (y1+y2)/2, delta);\n        }\n        touchesDistance = d;\n    }\n}\n\nfunction onMousemove(e:any)\n{\n    if (e.buttons==4) {\n        x.value += e.movementX / s.value;\n        y.value += e.movementY / s.value;\n    }\n    mouseX = e.clientX;\n    mouseY = e.clientY;\n    multiSelecting = e.buttons==1;\n}\n\nfunction onMousedown(e:any)\n{\n    if (e.buttons==1)\n    {\n        multiSelecting = true;\n        multiSelectStartX=e.clientX;\n        multiSelectStartY=e.clientY;\n    }\n    bgDownButtons = e.buttons;\n}\n\nlet bgDownButtons = 0;\n\n\nfunction onMouseup(e:any)\n{\n    if (bgDownButtons == 1)\n    {\n        state.value.selectedUsers = [];\n        state.value.focusedUser = -1;\n    }\n    if (multiSelecting && Math.abs(mouseX - multiSelectStartX) > 10 && Math.abs(mouseY - multiSelectStartY) > 10)\n    {\n        state.value.selectedUsers = state.value.users.filter(user=>\n        {\n            const ux = (user.x + x.value) * s.value;\n            const uy = (user.y + y.value) * s.value;\n            let newSelecteState = e.shiftKey?state.value.selectedUsers.includes(user.id):false;\n            if (((ux > multiSelectStartX && ux < mouseX) || (ux > mouseX && ux < multiSelectStartX))\n            && ((uy > multiSelectStartY && uy < mouseY) || (uy > mouseY && uy < multiSelectStartY)))\n            {\n                newSelecteState = true;\n            }\n            return newSelecteState;\n        }).map(user=>user.id);\n    }\n    multiSelecting = false;\n}\n\nfunction changeScale(mx:number, my:number, delta:number)\n{\n\n    let s1 = s.value;\n    let mx1 = mx / s1 - x.value;\n    let my1 = my / s1 - y.value;\n    s.value *= delta;\n    let s2 = s.value;\n    let mx2 = mx / s2 - x.value;\n    let my2 = my / s2 - y.value;\n    x.value += mx2 - mx1;\n    y.value += my2 - my1;\n}\n\nfunction onWheel(e:any)\n{\n    let delta = e.wheelDelta * 0.01;\n    if (delta < 0)\n    {\n        delta += 2.0;\n    }\n    if (delta < 0 || delta > 2.0) return;\n    changeScale(e.clientX, e.clientY, delta);\n}\n\nlet linesCanvas:any;\nlet linesCtx:any;\n\nconst idealDist = 150;\nconst delta = 1/60;\nconst stepLength = 100;\nconst d = delta * stepLength;\n\nfunction getForce(ax:number, ay:number, bx:number, by:number, repulsion:boolean, idealDistScale:number, strengthScale:number) {\n    const dx = bx - ax;\n    const dy = by - ay;\n    const ls = dx * dx + dy * dy;\n    const l = Math.sqrt(ls);\n    const tl = idealDist * idealDistScale;\n    const s = 15 * strengthScale;\n    let f = s * (l - tl) / ls * d;\n    if (repulsion && l >= tl)\n    {\n        f = 0;\n    }\n    return {\n        x: dx * f,\n        y: dy * f\n    }\n}\n\nonMounted(()=>{\n    linesCanvas = document.getElementById('lines');\n    linesCtx = linesCanvas.getContext(\"2d\");\n    setInterval(physicsProcess,delta*1000);\n    subscribe(\"createdUser\", (id:number)=>{\n        state.value.users.push({\n            id: id,\n            x: (id % 2) * 100,\n            y: Math.floor(id / 2) * 100,\n            vx: 0,\n            vy: 0\n        });\n    });\n    subscribe(\"removedUser\", ()=>{\n        state.value.users.pop();\n    });\n});\n\nfunction physicsProcess()\n{\n    const users = state.value.users;\n    for (let i = 0; i < progress.userCount-1; i++) {\n        const a = users[i];\n        for (let j = i + 1; j < progress.userCount; j++) {\n            const b = users[j];\n            const repulsion = getRepulsion(i,j);\n            let f = getForce(a.x, a.y, b.x, b.y, repulsion, repulsion?1:0.5, repulsion?0.5:0.5);\n            a.vx += f.x;\n            a.vy += f.y;\n            b.vx -= f.x;\n            b.vy -= f.y;\n        }\n    }\n    Object.values(state.value.users).forEach(user=>\n        {\n            user.vx *= 1 - (0.2 * d);\n            user.vy *= 1 - (0.2 * d);\n            user.vx -= user.x * 0.01 * d;\n            user.vy -= user.y * 0.01 * d;\n            user.x += user.vx * d;\n            user.y += user.vy * d;\n        }\n    )\n    redraw();\n}\n\nfunction redraw()\n{\n    if (appState.value==undefined) return;\n    linesCanvas.width = window.innerWidth;\n    linesCanvas.height = window.innerHeight;\n    if (appState.value.editingUser >= 0)\n    {\n        const graph = getSubjectUserGraph(appState.value.editingUser);\n        Object.entries(graph).forEach(([k,r])=>{\n            const splited = k.split('_');\n            const fromId = parseInt(splited[0],32);\n            const toId = parseInt(splited[1],32);\n            const from = state.value.users[fromId];\n            const to = state.value.users[toId];\n            let a = Math.abs(r);\n            if (a > 1) a = 1;\n            if (a < 0) return;\n            const x1 = (from.x+x.value)*s.value;\n            const y1 = (from.y+y.value)*s.value;\n            const x2 = (to.x+x.value)*s.value;\n            const y2 = (to.y+y.value)*s.value;\n            if (debugMode)\n            {\n                linesCtx.strokeStyle = '#000';\n                linesCtx.font = \"16px Arial\";\n                linesCtx.fillText(r.toFixed(2).toString(), (x1+x2)*0.5, (y1+y2)*0.5);\n            }\n            const style = `#${(r<0)?'ff':'00'}00${(r>=0)?'ff':'00'}${Math.floor(a*255).toString(16).padStart(2,'0')}`;\n            // const style = `#000`;\n            linesCtx.strokeStyle = style;\n            linesCtx.beginPath();\n            linesCtx.moveTo(x1, y1);\n            linesCtx.lineTo(x2, y2);\n            linesCtx.stroke();\n        });\n    }\n    else\n    {\n        for (const fromIdStr in progress.subjectiveUserGraph)\n        {\n            const fromId = parseInt(fromIdStr);\n            const from = state.value.users[fromId];\n            if (from==undefined) continue;\n            Object.entries(progress.subjectiveUserGraph[fromId]).forEach(([k,rFT])=>{\n                const splited = k.split('_');\n                const keyFrom = splited[0];\n                if (keyFrom != (fromId.toString())) return;\n                const toId = parseInt(splited[1],32);\n                const to = state.value.users[toId];\n                let aFT = Math.abs(rFT);\n                if (aFT > 1) aFT = 1;\n                const styleFT = `#${(rFT<0)?'ff':'00'}00${(rFT>=0)?'ff':'00'}${Math.floor(aFT*255).toString(16).padStart(2,'0')}`;\n                const rTF = rGetIn(fromId, toId, getSubjectUserGraph(toId));\n                let aTF = Math.abs(rTF);\n                if (aTF > 1) aTF = 1;\n                const styleTF = `#${(rTF<0)?'ff':'00'}00${(rTF>=0)?'ff':'00'}${Math.floor(aTF*255).toString(16).padStart(2,'0')}`;\n                const x1 = (from.x+x.value)*s.value;\n                const y1 = (from.y+y.value)*s.value;\n                const x2 = (to.x+x.value)*s.value;\n                const y2 = (to.y+y.value)*s.value;\n                const grd=linesCtx.createLinearGradient(x1, y1, x2, y2);\n                grd.addColorStop(0,styleFT);\n                grd.addColorStop(1,styleTF);\n                linesCtx.strokeStyle = grd;\n                linesCtx.beginPath();\n                linesCtx.moveTo(x1, y1);\n                linesCtx.lineTo(x2, y2);\n                linesCtx.stroke();\n            })\n        }\n    }\n    // for(let i=0;i<progress.userCount;i++)\n    // {\n    //     for(let j=i+1;j<progress.userCount;j++)\n    //     {\n    //         const from = state.value.users[i];\n    //         const to = state.value.users[j];\n    //         const repulsion = getRepulsion(i,j);\n    //         const style = `#00ff00${(!repulsion)?'ff':'00'}`;\n    //         linesCtx.strokeStyle = style;\n    //         linesCtx.beginPath();\n    //         linesCtx.moveTo((from.x+x.value)*s.value, (from.y+y.value)*s.value);\n    //         linesCtx.lineTo((to.x+x.value)*s.value, (to.y+y.value)*s.value);\n    //         linesCtx.stroke();\n    //     }\n    // }\n    const w = mouseX-multiSelectStartX;\n    const h = mouseY-multiSelectStartY;\n    if (multiSelecting && Math.abs(w) > 10 && Math.abs(h) > 10)\n    {\n        linesCtx.rect(multiSelectStartX, multiSelectStartY, w, h);\n        linesCtx.fillStyle = '#00000033';\n        linesCtx.fill();\n    }\n}\n\n</script>\n\n<style scoped>\n.canvas\n{\n    position: absolute;\n    width: 100vw;\n    height: 100vh;\n    scroll-behavior:unset;\n    background-image:\n    linear-gradient(to right, gainsboro 1px, transparent 1px),\n    linear-gradient(to bottom, gainsboro 1px, transparent 1px);\n}\n.bg\n{\n    position: absolute;\n    width: 100%;\n    height: 100%;\n}\n.mouse-input-handler\n{\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n}\n</style>","import { useModel as _useModel, defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, normalizeStyle as _normalizeStyle } from \"vue\"\n\nimport { debugMode, getRepulsion, getSubjectUserGraph, progress, rGetIn } from '../game'\nimport { onMounted, Ref, ref } from 'vue'\nimport CanvasUser from './CanvasUser.vue'\nimport { subscribe } from '../event'\nimport { AppState } from '@/App.vue';\ntype User = {\n    id: number;\n    x: number;\n    y: number;\n    vx: number;\n    vy: number;\n};\nconst idealDist = 150;\nconst delta = 1/60;\nconst stepLength = 100;\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'GameCanvas',\n  props: {\n    \"modelValue\": {},\n    \"modelModifiers\": {},\n  },\n  emits: [\"update:modelValue\"],\n  setup(__props) {\n\nconst state:Ref<{\n    users: Array<User>,\n    selectedUsers: Array<number>\n    focusedUser: number\n}> = ref({\n  users: [],\n  selectedUsers: [],\n  focusedUser: -1\n})\n\nsubscribe('resetProgress',()=>{\n    state.value = {\n        users: [],\n        selectedUsers: [],\n        focusedUser: -1\n    };\n})\n\nconst appState = _useModel<AppState>(__props, \"modelValue\");\n\nconst x = ref(0);\nconst y = ref(0);\nconst s = ref(1);\nsubscribe('userPressed', (id)=>\n{\n    if (appState.value?.mode == 'user-edit') return;\n    let selectedUsers = state.value.selectedUsers;\n    if (selectedUsers.includes(id))\n    {\n        if (state.value.focusedUser != id)\n        {\n            state.value.focusedUser = id;\n        }\n        else\n        {\n            state.value.selectedUsers = selectedUsers.filter(i=>i!=id);\n            state.value.focusedUser = -1;\n        }\n    }\n    else{\n        state.value.focusedUser = id;\n        selectedUsers.push(id);\n    }\n})\n\nlet multiSelecting = false;\nlet multiSelectStartX = 0;\nlet multiSelectStartY = 0;\nlet mouseX = 0;\nlet mouseY = 0;\nlet touchStartX = 0;\nlet touchStartY = 0;\nlet touchStartCanvasX = 0;\nlet touchStartCanvasY = 0;\nlet touchesDistance = -1;\n\nfunction onTouchStart(e: TouchEvent)\n{\n    e.preventDefault();\n    if (e.touches.length == 1)\n    {\n        const touch = e.touches[0];\n        touchStartX = touch.clientX;\n        touchStartY = touch.clientY;\n        touchStartCanvasX = x.value;\n        touchStartCanvasY = y.value;\n    }\n}\n\nfunction onTouchEnd(e: TouchEvent)\n{\n    e.preventDefault();\n    if (e.touches.length == 0)\n    {\n        touchesDistance = -1;\n    }\n}\n\nfunction onTouchMove(e: TouchEvent)\n{\n    e.preventDefault();\n    if (e.touches.length == 1 && touchesDistance == -1)\n    {\n        const touch = e.touches[0];\n        mouseX = touch.clientX;\n        mouseY = touch.clientY;\n        x.value = mouseX - touchStartX + touchStartCanvasX;\n        y.value = mouseY - touchStartY + touchStartCanvasY;\n    }\n    else if (e.touches.length == 2)\n    {\n        const x1 = e.touches[0].clientX;\n        const y1 = e.touches[0].clientY;\n        const x2 = e.touches[1].clientX;\n        const y2 = e.touches[1].clientY;\n        const d = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n        if (touchesDistance>0)\n        {\n            let delta = (d - touchesDistance) * 0.01;\n            if (delta < -1)\n            {\n                delta = -1;\n            }\n            if (delta > 1)\n            {\n                delta = 1;\n            }\n            delta += 1;\n            // if (delta < 0)\n            // {\n            //     delta += 1;\n            // }\n            changeScale((x1+x2)/2, (y1+y2)/2, delta);\n        }\n        touchesDistance = d;\n    }\n}\n\nfunction onMousemove(e:any)\n{\n    if (e.buttons==4) {\n        x.value += e.movementX / s.value;\n        y.value += e.movementY / s.value;\n    }\n    mouseX = e.clientX;\n    mouseY = e.clientY;\n    multiSelecting = e.buttons==1;\n}\n\nfunction onMousedown(e:any)\n{\n    if (e.buttons==1)\n    {\n        multiSelecting = true;\n        multiSelectStartX=e.clientX;\n        multiSelectStartY=e.clientY;\n    }\n    bgDownButtons = e.buttons;\n}\n\nlet bgDownButtons = 0;\n\n\nfunction onMouseup(e:any)\n{\n    if (bgDownButtons == 1)\n    {\n        state.value.selectedUsers = [];\n        state.value.focusedUser = -1;\n    }\n    if (multiSelecting && Math.abs(mouseX - multiSelectStartX) > 10 && Math.abs(mouseY - multiSelectStartY) > 10)\n    {\n        state.value.selectedUsers = state.value.users.filter(user=>\n        {\n            const ux = (user.x + x.value) * s.value;\n            const uy = (user.y + y.value) * s.value;\n            let newSelecteState = e.shiftKey?state.value.selectedUsers.includes(user.id):false;\n            if (((ux > multiSelectStartX && ux < mouseX) || (ux > mouseX && ux < multiSelectStartX))\n            && ((uy > multiSelectStartY && uy < mouseY) || (uy > mouseY && uy < multiSelectStartY)))\n            {\n                newSelecteState = true;\n            }\n            return newSelecteState;\n        }).map(user=>user.id);\n    }\n    multiSelecting = false;\n}\n\nfunction changeScale(mx:number, my:number, delta:number)\n{\n\n    let s1 = s.value;\n    let mx1 = mx / s1 - x.value;\n    let my1 = my / s1 - y.value;\n    s.value *= delta;\n    let s2 = s.value;\n    let mx2 = mx / s2 - x.value;\n    let my2 = my / s2 - y.value;\n    x.value += mx2 - mx1;\n    y.value += my2 - my1;\n}\n\nfunction onWheel(e:any)\n{\n    let delta = e.wheelDelta * 0.01;\n    if (delta < 0)\n    {\n        delta += 2.0;\n    }\n    if (delta < 0 || delta > 2.0) return;\n    changeScale(e.clientX, e.clientY, delta);\n}\n\nlet linesCanvas:any;\nlet linesCtx:any;\n\nconst d = delta * stepLength;\n\nfunction getForce(ax:number, ay:number, bx:number, by:number, repulsion:boolean, idealDistScale:number, strengthScale:number) {\n    const dx = bx - ax;\n    const dy = by - ay;\n    const ls = dx * dx + dy * dy;\n    const l = Math.sqrt(ls);\n    const tl = idealDist * idealDistScale;\n    const s = 15 * strengthScale;\n    let f = s * (l - tl) / ls * d;\n    if (repulsion && l >= tl)\n    {\n        f = 0;\n    }\n    return {\n        x: dx * f,\n        y: dy * f\n    }\n}\n\nonMounted(()=>{\n    linesCanvas = document.getElementById('lines');\n    linesCtx = linesCanvas.getContext(\"2d\");\n    setInterval(physicsProcess,delta*1000);\n    subscribe(\"createdUser\", (id:number)=>{\n        state.value.users.push({\n            id: id,\n            x: (id % 2) * 100,\n            y: Math.floor(id / 2) * 100,\n            vx: 0,\n            vy: 0\n        });\n    });\n    subscribe(\"removedUser\", ()=>{\n        state.value.users.pop();\n    });\n});\n\nfunction physicsProcess()\n{\n    const users = state.value.users;\n    for (let i = 0; i < progress.userCount-1; i++) {\n        const a = users[i];\n        for (let j = i + 1; j < progress.userCount; j++) {\n            const b = users[j];\n            const repulsion = getRepulsion(i,j);\n            let f = getForce(a.x, a.y, b.x, b.y, repulsion, repulsion?1:0.5, repulsion?0.5:0.5);\n            a.vx += f.x;\n            a.vy += f.y;\n            b.vx -= f.x;\n            b.vy -= f.y;\n        }\n    }\n    Object.values(state.value.users).forEach(user=>\n        {\n            user.vx *= 1 - (0.2 * d);\n            user.vy *= 1 - (0.2 * d);\n            user.vx -= user.x * 0.01 * d;\n            user.vy -= user.y * 0.01 * d;\n            user.x += user.vx * d;\n            user.y += user.vy * d;\n        }\n    )\n    redraw();\n}\n\nfunction redraw()\n{\n    if (appState.value==undefined) return;\n    linesCanvas.width = window.innerWidth;\n    linesCanvas.height = window.innerHeight;\n    if (appState.value.editingUser >= 0)\n    {\n        const graph = getSubjectUserGraph(appState.value.editingUser);\n        Object.entries(graph).forEach(([k,r])=>{\n            const splited = k.split('_');\n            const fromId = parseInt(splited[0],32);\n            const toId = parseInt(splited[1],32);\n            const from = state.value.users[fromId];\n            const to = state.value.users[toId];\n            let a = Math.abs(r);\n            if (a > 1) a = 1;\n            if (a < 0) return;\n            const x1 = (from.x+x.value)*s.value;\n            const y1 = (from.y+y.value)*s.value;\n            const x2 = (to.x+x.value)*s.value;\n            const y2 = (to.y+y.value)*s.value;\n            if (debugMode)\n            {\n                linesCtx.strokeStyle = '#000';\n                linesCtx.font = \"16px Arial\";\n                linesCtx.fillText(r.toFixed(2).toString(), (x1+x2)*0.5, (y1+y2)*0.5);\n            }\n            const style = `#${(r<0)?'ff':'00'}00${(r>=0)?'ff':'00'}${Math.floor(a*255).toString(16).padStart(2,'0')}`;\n            // const style = `#000`;\n            linesCtx.strokeStyle = style;\n            linesCtx.beginPath();\n            linesCtx.moveTo(x1, y1);\n            linesCtx.lineTo(x2, y2);\n            linesCtx.stroke();\n        });\n    }\n    else\n    {\n        for (const fromIdStr in progress.subjectiveUserGraph)\n        {\n            const fromId = parseInt(fromIdStr);\n            const from = state.value.users[fromId];\n            if (from==undefined) continue;\n            Object.entries(progress.subjectiveUserGraph[fromId]).forEach(([k,rFT])=>{\n                const splited = k.split('_');\n                const keyFrom = splited[0];\n                if (keyFrom != (fromId.toString())) return;\n                const toId = parseInt(splited[1],32);\n                const to = state.value.users[toId];\n                let aFT = Math.abs(rFT);\n                if (aFT > 1) aFT = 1;\n                const styleFT = `#${(rFT<0)?'ff':'00'}00${(rFT>=0)?'ff':'00'}${Math.floor(aFT*255).toString(16).padStart(2,'0')}`;\n                const rTF = rGetIn(fromId, toId, getSubjectUserGraph(toId));\n                let aTF = Math.abs(rTF);\n                if (aTF > 1) aTF = 1;\n                const styleTF = `#${(rTF<0)?'ff':'00'}00${(rTF>=0)?'ff':'00'}${Math.floor(aTF*255).toString(16).padStart(2,'0')}`;\n                const x1 = (from.x+x.value)*s.value;\n                const y1 = (from.y+y.value)*s.value;\n                const x2 = (to.x+x.value)*s.value;\n                const y2 = (to.y+y.value)*s.value;\n                const grd=linesCtx.createLinearGradient(x1, y1, x2, y2);\n                grd.addColorStop(0,styleFT);\n                grd.addColorStop(1,styleTF);\n                linesCtx.strokeStyle = grd;\n                linesCtx.beginPath();\n                linesCtx.moveTo(x1, y1);\n                linesCtx.lineTo(x2, y2);\n                linesCtx.stroke();\n            })\n        }\n    }\n    // for(let i=0;i<progress.userCount;i++)\n    // {\n    //     for(let j=i+1;j<progress.userCount;j++)\n    //     {\n    //         const from = state.value.users[i];\n    //         const to = state.value.users[j];\n    //         const repulsion = getRepulsion(i,j);\n    //         const style = `#00ff00${(!repulsion)?'ff':'00'}`;\n    //         linesCtx.strokeStyle = style;\n    //         linesCtx.beginPath();\n    //         linesCtx.moveTo((from.x+x.value)*s.value, (from.y+y.value)*s.value);\n    //         linesCtx.lineTo((to.x+x.value)*s.value, (to.y+y.value)*s.value);\n    //         linesCtx.stroke();\n    //     }\n    // }\n    const w = mouseX-multiSelectStartX;\n    const h = mouseY-multiSelectStartY;\n    if (multiSelecting && Math.abs(w) > 10 && Math.abs(h) > 10)\n    {\n        linesCtx.rect(multiSelectStartX, multiSelectStartY, w, h);\n        linesCtx.fillStyle = '#00000033';\n        linesCtx.fill();\n    }\n}\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"canvas\",\n    style: _normalizeStyle({'background-size': 20*s.value+'px '+20*s.value+'px', 'background-position': x.value*s.value+'px '+y.value*s.value+'px'})\n  }, [\n    _createElementVNode(\"div\", {\n      class: \"mouse-input-handler\",\n      onMousedown: onMousedown,\n      onMouseup: onMouseup,\n      onMousemove: onMousemove,\n      onTouchstart: onTouchStart,\n      onTouchend: onTouchEnd,\n      onTouchmove: onTouchMove,\n      onWheel: onWheel\n    }, null, 32),\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(state.value.users, (user) => {\n      return (_openBlock(), _createBlock(CanvasUser, {\n        key: user.id,\n        id: user.id,\n        x: user.x,\n        y: user.y,\n        px: x.value,\n        py: y.value,\n        ps: s.value,\n        selected: state.value.selectedUsers.includes(user.id),\n        focused: state.value.focusedUser==user.id,\n        \"badge-default\": ((user.id in (appState.value?.uncollectedMessages??{}))?appState.value?.uncollectedMessages[user.id].length:0)??0,\n        \"badge-info\": 0\n      }, null, 8, [\"id\", \"x\", \"y\", \"px\", \"py\", \"ps\", \"selected\", \"focused\", \"badge-default\"]))\n    }), 128)),\n    _cache[0] || (_cache[0] = _createElementVNode(\"canvas\", { id: \"lines\" }, null, -1))\n  ], 4))\n}\n}\n\n})","import script from \"./GameCanvas.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./GameCanvas.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./GameCanvas.vue?vue&type=style&index=0&id=08cb9044&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-08cb9044\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, createElementBlock as _createElementBlock, renderSlot as _renderSlot } from \"vue\"\n\nconst _hoisted_1 = { key: 1 }\nconst _hoisted_2 = { class: \"author\" }\nconst _hoisted_3 = { key: 1 }\n\nimport { Message } from '@/game';\nimport { ref } from 'vue';\nimport { NCard, NSkeleton, NEllipsis } from 'naive-ui';\nimport { getUserName, text } from '@/text';\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MessageCard',\n  props: {\n    msg: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\nlet title = ref(\"\");\nlet content = ref(\"\");\nconst intervalId = setInterval(()=>{\n    const messageText = text.messageTexts[props.msg.id];\n    if (typeof(messageText)!=\"undefined\" && messageText.title != '')\n    {\n        title.value = messageText.title;\n        content.value = messageText.content;\n        // clearInterval(intervalId);\n    }\n}, 1);\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(_unref(NCard), {\n    class: \"message-card\",\n    hoverable: \"\"\n  }, {\n    header: _withCtx(() => [\n      (_unref(title)=='')\n        ? (_openBlock(), _createBlock(_unref(NSkeleton), {\n            key: 0,\n            width: 100,\n            round: \"\"\n          }))\n        : (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n            _createElementVNode(\"h3\", null, [\n              _createVNode(_unref(NEllipsis), { \"line-clamp\": 2 }, {\n                default: _withCtx(() => [\n                  _createTextVNode(_toDisplayString(_unref(title)), 1)\n                ]),\n                _: 1\n              })\n            ])\n          ]))\n    ]),\n    \"header-extra\": _withCtx(() => [\n      _renderSlot(_ctx.$slots, \"header-extra\")\n    ]),\n    action: _withCtx(() => [\n      _renderSlot(_ctx.$slots, \"action\")\n    ]),\n    default: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_2, _toDisplayString(_unref(getUserName)(__props.msg.a)) + \" 发布于 \" + _toDisplayString(__props.msg.t), 1),\n      (_unref(content)=='')\n        ? (_openBlock(), _createBlock(_unref(NSkeleton), {\n            key: 0,\n            text: \"\",\n            repeat: 2\n          }))\n        : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n            _createElementVNode(\"p\", null, [\n              _createVNode(_unref(NEllipsis), { \"line-clamp\": 2 }, {\n                default: _withCtx(() => [\n                  _createTextVNode(_toDisplayString(_unref(content)), 1)\n                ]),\n                _: 1\n              })\n            ])\n          ])),\n      _renderSlot(_ctx.$slots, \"suffix\")\n    ]),\n    _: 3\n  }))\n}\n}\n\n})","<template>\n<n-card class=\"message-card\" hoverable>\n    <template #header>\n        <n-skeleton v-if=\"title==''\" :width=\"100\" round />\n        <div v-else>\n            <h3><n-ellipsis :line-clamp=\"2\">{{ title }}</n-ellipsis></h3>\n        </div>\n    </template>\n    <template #header-extra>\n        <slot name=\"header-extra\"></slot>\n    </template>\n    <div class=\"author\">{{ getUserName(msg.a) }} 发布于 {{msg.t}}</div>\n    <n-skeleton v-if=\"content==''\" text :repeat=\"2\"/>\n    <div v-else>\n        <p><n-ellipsis :line-clamp=\"2\">{{ content }}</n-ellipsis></p>\n    </div>\n    <slot name=\"suffix\"></slot>\n    <template #action>\n        <slot name=\"action\"></slot>\n    </template>\n</n-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { Message } from '@/game';\nimport { defineProps, ref } from 'vue';\nimport { NCard, NSkeleton, NEllipsis } from 'naive-ui';\nimport { getUserName, text } from '@/text';\n\nconst props = defineProps<{msg:Message}>();\nlet title = ref(\"\");\nlet content = ref(\"\");\nconst intervalId = setInterval(()=>{\n    const messageText = text.messageTexts[props.msg.id];\n    if (typeof(messageText)!=\"undefined\" && messageText.title != '')\n    {\n        title.value = messageText.title;\n        content.value = messageText.content;\n        // clearInterval(intervalId);\n    }\n}, 1);\n</script>\n\n<style scoped>\n.message-card\n{\n    margin-left: auto;\n    margin-right: auto;\n    margin-top: 20px;\n    padding: 10px;\n    box-shadow:0px 0px 3px 0px rgba(0,0,0,0.5);\n}\n.author\n{\n    font-size: 16px;\n}\n</style>","import script from \"./MessageCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MessageCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MessageCard.vue?vue&type=style&index=0&id=a1734486&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-a1734486\"]])\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { Message, progress } from '@/game';\nimport { DataTableColumns } from 'naive-ui';\n\nimport { NDataTable } from 'naive-ui';\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MessageList',\n  props: /*@__PURE__*/_mergeModels({\n    source: {},\n    filter: { type: Function },\n    select: { type: Boolean }\n  }, {\n    \"modelValue\": {},\n    \"modelModifiers\": {},\n  }),\n  emits: [\"update:modelValue\"],\n  setup(__props: any) {\n\nconst props = __props;\n\nconst checkedRowKeys=_useModel<Array<number>>(__props, \"modelValue\");\n\nfunction createColumns(): DataTableColumns<Message> {\n  return [\n    {\n      title: '创作群体',\n      key: 'i'\n    },\n    {\n      title: '时间',\n      key: 't'\n    },\n    {\n      title: '涉及群体',\n      key: 'j'\n    },\n    {\n      title: '态度',\n      key: 'v'\n    }\n  ]\n}\n\nlet columns=createColumns();\n\nif (props.select)\n{\n  columns = [{\n    type: 'selection',\n    multiple: true,\n    disabled: (row)=>!props.filter(progress.messages[row.id])\n  }, ...columns]\n}\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(_unref(NDataTable), {\n    \"checked-row-keys\": checkedRowKeys.value,\n    \"onUpdate:checkedRowKeys\": _cache[0] || (_cache[0] = ($event: any) => ((checkedRowKeys).value = $event)),\n    columns: _unref(columns),\n    data: __props.source,\n    pagination: false,\n    bordered: false,\n    \"row-key\": (msg)=>msg.id,\n    striped: \"\"\n  }, null, 8, [\"checked-row-keys\", \"columns\", \"data\", \"row-key\"]))\n}\n}\n\n})","<template>\n<n-data-table\n    v-model:checked-row-keys=\"checkedRowKeys\"\n    :columns=\"columns\"\n    :data=\"source\"\n    :pagination=\"false\"\n    :bordered=\"false\"\n    :row-key=\"(msg:Message)=>msg.id\"\nstriped />\n</template>\n\n<script setup lang=\"ts\">\nimport { Message, progress } from '@/game';\nimport { DataTableColumns } from 'naive-ui';\nimport { defineProps, defineModel } from 'vue';\nimport { NDataTable } from 'naive-ui';\nconst props = defineProps<{source:Array<Message>,filter:(msg:Message)=>boolean,select:boolean}>();\n\nconst checkedRowKeys=defineModel<Array<number>>();\n\nfunction createColumns(): DataTableColumns<Message> {\n  return [\n    {\n      title: '创作群体',\n      key: 'i'\n    },\n    {\n      title: '时间',\n      key: 't'\n    },\n    {\n      title: '涉及群体',\n      key: 'j'\n    },\n    {\n      title: '态度',\n      key: 'v'\n    }\n  ]\n}\n\nlet columns=createColumns();\n\nif (props.select)\n{\n  columns = [{\n    type: 'selection',\n    multiple: true,\n    disabled: (row)=>!props.filter(progress.messages[row.id])\n  }, ...columns]\n}\n\n</script>\n\n<style scoped>\n\n</style>","import script from \"./MessageList.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MessageList.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { useModel as _useModel, mergeModels as _mergeModels, defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, unref as _unref, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\"\n\nimport { progress } from '@/game';\nimport MessageCard from './MessageCard.vue';\nimport draggable from 'vuedraggable';\n\nimport { NButton, NInput, NTag, NCard } from 'naive-ui';\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'MessageFlow',\n  props: /*@__PURE__*/_mergeModels({\n    flow: {}\n  }, {\n    \"source\": {},\n    \"sourceModifiers\": {},\n    \"label\": {},\n    \"labelModifiers\": {},\n  }),\n  emits: [\"update:source\", \"update:label\"],\n  setup(__props: any) {\n\n\nconst source = _useModel<Array<number>>(__props, \"source\");\nconst label = _useModel<string>(__props, \"label\");\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_center = _resolveComponent(\"center\")!\n\n  return (_openBlock(), _createBlock(_unref(NCard), { class: \"flow noscroll\" }, {\n    default: _withCtx(() => [\n      _createVNode(_component_center, null, {\n        default: _withCtx(() => [\n          (__props.flow==0)\n            ? (_openBlock(), _createBlock(_unref(NTag), { key: 0 }, {\n                default: _withCtx(() => [...(_cache[2] || (_cache[2] = [\n                  _createTextVNode(\"主推送流\", -1)\n                ]))]),\n                _: 1\n              }))\n            : (_openBlock(), _createBlock(_unref(NInput), {\n                key: 1,\n                value: label.value,\n                \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((label).value = $event)),\n                size: \"small\",\n                type: \"text\",\n                placeholder: \"自定义推送流\"\n              }, null, 8, [\"value\"]))\n        ]),\n        _: 1\n      }),\n      _createVNode(_unref(draggable), {\n        modelValue: source.value,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((source).value = $event)),\n        animation: \"200\",\n        \"item-key\": \"element\",\n        group: \"flow\",\n        style: {\"height\":\"100%\"}\n      }, {\n        item: _withCtx((element) => [\n          _createElementVNode(\"div\", null, [\n            _createVNode(MessageCard, {\n              msg: _unref(progress).messages[element.element]\n            }, {\n              \"header-extra\": _withCtx(() => [\n                _createElementVNode(\"b\", null, _toDisplayString((source.value?.length??0) - element.index) + \"x\", 1)\n              ]),\n              _: 2\n            }, 1032, [\"msg\"])\n          ])\n        ]),\n        _: 1\n      }, 8, [\"modelValue\"])\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","<template>\n    <n-card class=\"flow noscroll\">\n        <center>\n            <n-tag v-if=\"flow==0\">主推送流</n-tag>\n            <n-input v-else v-model:value=\"label\" size=\"small\" type=\"text\" placeholder=\"自定义推送流\"/>\n        </center>\n        <draggable\n            v-model=\"source\"\n            animation=\"200\"\n            item-key=\"element\"\n            group=\"flow\"\n            style=\"height: 100%;\"\n        >\n        <template #item=\"element\">\n            <div>\n                <MessageCard :msg=\"progress.messages[element.element]\">\n                    <template #header-extra>\n                        <b>{{ (source?.length??0) - element.index }}x</b>\n                    </template>\n                </MessageCard>\n            </div>\n        </template>\n        <!-- <p>{{ element }}</p> -->\n        </draggable>\n    </n-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { progress } from '@/game';\nimport MessageCard from './MessageCard.vue';\nimport draggable from 'vuedraggable';\nimport { defineProps, defineModel } from 'vue';\nimport { NButton, NInput, NTag, NCard } from 'naive-ui';\n\ndefineProps<{flow:number}>();\nconst source = defineModel<Array<number>>(\"source\");\nconst label = defineModel<string>(\"label\");\n</script>","import script from \"./MessageFlow.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MessageFlow.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, unref as _unref, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, createBlock as _createBlock, isRef as _isRef, toDisplayString as _toDisplayString } from \"vue\"\n\nconst _hoisted_1 = { class: \"app\" }\nconst _hoisted_2 = { class: \"flows\" }\nconst _hoisted_3 = { class: \"pagebottom\" }\nconst _hoisted_4 = { class: \"buttons\" }\nconst _hoisted_5 = { class: \"score\" }\nconst _hoisted_6 = { class: \"buttons\" }\n\nimport { computed, nextTick, onMounted, Ref, ref, watch } from 'vue';\nimport GameCanvas from './components/GameCanvas.vue';\nimport MessageCard from './components/MessageCard.vue';\nimport MessageList from './components/MessageList.vue';\nimport { createUser, Message, progress, processPushTask, getSubjectUserGraph, rSetIn, updateUsers, setProgress, resetProgress } from './game';\nimport { subscribe } from './event';\nimport { NPageHeader, NTabs, NTabPane, NDrawer, NDrawerContent, NButton, NFlex, NDynamicTags, AutoCompleteInst, NAutoComplete, NCard, NModal, NIcon, NRow, NCol, NNumberAnimation, NStatistic, NDivider } from 'naive-ui';\nimport { getUserName, loadText, processGenerateQueue, resetText, text } from './text';\nimport { startGenerateMessage } from './text';\nimport MessageFlow from './components/MessageFlow.vue';\nimport { View, ThumbsUp, AnalyticsReference, AiResultsHigh, Time, Network1 } from '@vicons/carbon'\n\nexport interface AppState {\n    mode: \"user-edit\" | \"connect\" | \"disconnect\";\n    editingUser: number;\n    uncollectedMessages: Record<number,Array<number>>;\n    flows: Array<Array<number>>;\n    messageStatistic: Array<{msg:number,views:number,likes:number,exposure:number,score:number}>;\n}\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'App',\n  setup(__props) {\n\nonMounted(()=>{\n    // const progressSource = localStorage.getItem('progress');\n    // if (progressSource != null)\n    // {\n    //     setProgress(JSON.parse(progressSource));\n    //     gameScore.value = progress.score;\n    //     gameTime.value = progress.time;\n    // }\n    // else\n    // {\n        \n    // }\n    // const appstateSource = localStorage.getItem('appstate');\n    // if (appstateSource != null)\n    // {\n    //     appState.value = JSON.parse(appstateSource);\n    // }\n    // loadText();\n    window.addEventListener('beforeunload', ()=>{\n        localStorage.setItem('appstate', JSON.stringify(appState.value))\n        localStorage.setItem('progress', JSON.stringify(progress));\n    });\n    gameInit();\n});\n\nconst appState:Ref<AppState> = ref({\n    mode:'user-edit',\n    editingUser:-1,\n    uncollectedMessages:{},\n    flows:[[]],\n    messageStatistic:[]\n});\n\nconst showUserEditor = ref(false);\nconst showFlowsEditor = ref(false);\n\nconst messages = ref(progress.messages);\nfunction getUserMessages(author:number)\n{\n    return messages.value.filter(m=>m.i==author);\n}\n\nconst editingFlowTags:Ref<Array<string>> = ref([]);\nfunction onCreateFlowTag(tag:string):string\n{\n    if (editingFlowTags.value.includes(tag))return \"\";\n    const flow = text.flowLabel.indexOf(tag);\n    if (flow==undefined) return \"\";\n    if (flow<=0) return \"\";\n    return tag;\n}\nconst autoCompleteInstRef = ref<AutoCompleteInst | null>(null)\nwatch(autoCompleteInstRef, (value) => {\n  if (value)\n    nextTick(() => value.focus())\n})\nconst flowTagInputValue = ref('');\nconst flowTagOptions = computed(() => {\n  if (flowTagInputValue.value === null) {\n    return []\n  }\n  return text.flowLabel.filter(label=>!editingFlowTags.value.includes(label)&&label.includes(flowTagInputValue.value)).map((completion) => {\n    return {\n      label: completion,\n      value: completion\n    }\n  })\n})\nsubscribe('userPressed', (id)=>\n{\n    if (progress.userType[id]==0)\n    {\n        if (appState.value.mode==\"user-edit\")\n        {\n            showUserEditor.value = true;\n            appState.value.editingUser = id;\n            while (progress.userFlowTags.length <= id)\n            {\n                progress.userFlowTags.push([]);\n            }\n            editingFlowTags.value = progress.userFlowTags[id].map(flow=>text.flowLabel[flow]);\n        }\n    }\n})\n\nsubscribe('addedMessage', (msg:Message)=>{\n    if (!(msg.a in appState.value.uncollectedMessages))\n    {\n        appState.value.uncollectedMessages[msg.a] = [];\n    }\n    appState.value.uncollectedMessages[msg.a].push(msg.id);\n});\n\nfunction forgetMsg(msg:Message)\n{\n    appState.value.uncollectedMessages[msg.a] = appState.value.uncollectedMessages[msg.a].filter(m=>m!=msg.id);\n}\nfunction collectMsg(msg:Message)\n{\n    forgetMsg(msg);\n    appState.value.flows[0].push(msg.id);\n}\nfunction finishRound()\n{\n    progress.time += 1;\n    gameTime.value = progress.time;\n    appState.value.uncollectedMessages = {};\n    for(let flow=0;flow<appState.value.flows.length;flow++)\n    {\n        processPushTask(appState.value.flows[flow],flow);\n        appState.value.flows[flow] = [];\n    }\n    updateUsers();\n    if (Object.keys (appState.value.uncollectedMessages).length==0)\n    {\n        gameEnded.value = true;\n    }\n    else if (appState.value.messageStatistic.length>0)\n    {\n        appState.value.messageStatistic = appState.value.messageStatistic.sort((s1,s2)=>s2.exposure-s1.exposure);\n        showStatistic.value = true;\n    }\n}\nsubscribe('addedMessage', (msg:Message)=>startGenerateMessage(msg));\nsetInterval(() => {\n    processGenerateQueue();\n}, 1000);\nsetInterval(() => {\n    windowWidth.value = window.innerWidth;\n}, 1);\nconst windowWidth = ref(0);\nfunction checkoutMessageStatistic(msgId:number)\n{\n    for (let i=0;i<appState.value.messageStatistic.length;i++)\n    {\n        if (appState.value.messageStatistic[i].msg == msgId) return i;\n    }\n    appState.value.messageStatistic.push({msg:msgId,views:0,likes:0,exposure:0,score:0});\n    return appState.value.messageStatistic.length-1;\n}\nsubscribe('viewedMessage',(msgId,view)=>{\n    appState.value.messageStatistic[checkoutMessageStatistic(msgId)].views = view;\n})\nsubscribe('likedMessage',(msgId,like)=>{\n    appState.value.messageStatistic[checkoutMessageStatistic(msgId)].likes = like;\n})\nsubscribe('messageKnownExposure',(msgId,exposure)=>{\n    appState.value.messageStatistic[checkoutMessageStatistic(msgId)].exposure = exposure;\n})\nsubscribe('messageGainedScore',(msgId,score)=>{\n    appState.value.messageStatistic[checkoutMessageStatistic(msgId)].score = score;\n    progress.score += score;\n    gameScore.value = progress.score;\n    roundScore += score;\n})\nconst showStatistic = ref(false);\nlet roundScore = 0;\nconst gameScore = ref(0);\nconst gameTime = ref(0);\nconst gameEnded = ref(false);\nsubscribe('resetProgress', ()=>{\n    appState.value={\n        mode:'user-edit',\n        editingUser:-1,\n        uncollectedMessages:{},\n        flows:[[]],\n        messageStatistic:[]\n    };\n    gameTime.value = 0;\n    gameScore.value = 0;\n    resetText();\n    gameInit();\n});\nfunction gameInit()\n{\n    createUser(0);\n    createUser(0);\n    createUser(0);\n    createUser(0);\n    for(let p=0;p<progress.userCount;p++)\n    {\n        const G = getSubjectUserGraph(p);\n        // for(let x=0;x<4;x++)\n        // {\n        //     for(let o=0;o<4;o++)\n        //     {\n        //         rSetIn(x,o,1,G);\n        //     }\n        // }\n        for(let x=0;x<4;x++)\n        {\n            rSetIn(p,x,(Math.random()*2-1)*2,G);\n        }\n    }\n    text.userTexts.push(\n        {\n            name: \"A\",\n            prompt: \"\"\n        },\n        {\n            name: \"B\",\n            prompt: \"\"\n        },\n        {\n            name: \"C\",\n            prompt: \"\"\n        },\n        {\n            name: \"D\",\n            prompt: \"\"\n        }\n    );\n    finishRound();\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_center = _resolveComponent(\"center\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(GameCanvas, {\n      modelValue: appState.value,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((appState).value = $event)),\n      ref: \"canvas\"\n    }, null, 8, [\"modelValue\"]),\n    _createVNode(_unref(NModal), {\n      show: showStatistic.value,\n      \"onUpdate:show\": _cache[1] || (_cache[1] = ($event: any) => ((showStatistic).value = $event)),\n      preset: \"card\",\n      style: {\"width\":\"600px\"},\n      title: `第${_unref(progress).time}回合统计`,\n      size: \"huge\",\n      bordered: false,\n      onUpdateShow: _cache[2] || (_cache[2] = (show)=>{if(!show){appState.value.messageStatistic=[];_isRef(roundScore) //@ts-ignore\n ? roundScore.value = 0 : roundScore=0;}})\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_component_center, null, {\n          default: _withCtx(() => [\n            _cache[15] || (_cache[15] = _createElementVNode(\"h3\", null, \"总得分\", -1)),\n            _createElementVNode(\"h1\", null, [\n              _createVNode(_unref(NNumberAnimation), {\n                to: Math.floor(_unref(roundScore))\n              }, null, 8, [\"to\"])\n            ])\n          ]),\n          _: 1\n        }),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(appState.value.messageStatistic, (statistic) => {\n          return (_openBlock(), _createBlock(MessageCard, {\n            key: statistic.msg,\n            msg: _unref(progress).messages[statistic.msg]\n          }, {\n            suffix: _withCtx(() => [\n              _createVNode(_unref(NRow), null, {\n                default: _withCtx(() => [\n                  _createVNode(_unref(NCol), { span: 12 }, {\n                    default: _withCtx(() => [\n                      _createVNode(_unref(NStatistic), {\n                        label: \"浏览\",\n                        value: statistic.views.toFixed(3)\n                      }, {\n                        prefix: _withCtx(() => [\n                          _createVNode(_unref(NIcon), null, {\n                            default: _withCtx(() => [\n                              _createVNode(_unref(View))\n                            ]),\n                            _: 1\n                          })\n                        ]),\n                        suffix: _withCtx(() => [...(_cache[16] || (_cache[16] = [\n                          _createTextVNode(\"K\", -1)\n                        ]))]),\n                        _: 1\n                      }, 8, [\"value\"])\n                    ]),\n                    _: 2\n                  }, 1024),\n                  _createVNode(_unref(NCol), { span: 12 }, {\n                    default: _withCtx(() => [\n                      _createVNode(_unref(NStatistic), {\n                        label: \"点赞\",\n                        value: (statistic.likes*(Math.abs(Math.random()-0.8)+0.8)).toFixed(3)\n                      }, {\n                        prefix: _withCtx(() => [\n                          _createVNode(_unref(NIcon), null, {\n                            default: _withCtx(() => [\n                              _createVNode(_unref(ThumbsUp))\n                            ]),\n                            _: 1\n                          })\n                        ]),\n                        suffix: _withCtx(() => [...(_cache[17] || (_cache[17] = [\n                          _createTextVNode(\"K\", -1)\n                        ]))]),\n                        _: 1\n                      }, 8, [\"value\"])\n                    ]),\n                    _: 2\n                  }, 1024),\n                  _createVNode(_unref(NCol), { span: 12 }, {\n                    default: _withCtx(() => [\n                      _createVNode(_unref(NStatistic), {\n                        label: \"曝光倍率\",\n                        value: statistic.exposure\n                      }, {\n                        prefix: _withCtx(() => [\n                          _createVNode(_unref(NIcon), null, {\n                            default: _withCtx(() => [\n                              _createVNode(_unref(AnalyticsReference))\n                            ]),\n                            _: 1\n                          })\n                        ]),\n                        suffix: _withCtx(() => [...(_cache[18] || (_cache[18] = [\n                          _createTextVNode(\"x\", -1)\n                        ]))]),\n                        _: 1\n                      }, 8, [\"value\"])\n                    ]),\n                    _: 2\n                  }, 1024),\n                  _createVNode(_unref(NCol), { span: 12 }, {\n                    default: _withCtx(() => [\n                      _createVNode(_unref(NStatistic), {\n                        label: \"得分\",\n                        value: statistic.score.toFixed()\n                      }, {\n                        prefix: _withCtx(() => [\n                          _createVNode(_unref(NIcon), null, {\n                            default: _withCtx(() => [\n                              _createVNode(_unref(AiResultsHigh))\n                            ]),\n                            _: 1\n                          })\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"])\n                    ]),\n                    _: 2\n                  }, 1024)\n                ]),\n                _: 2\n              }, 1024)\n            ]),\n            _: 2\n          }, 1032, [\"msg\"]))\n        }), 128))\n      ]),\n      _: 1\n    }, 8, [\"show\", \"title\"]),\n    _createVNode(_unref(NDrawer), {\n      show: showFlowsEditor.value,\n      \"onUpdate:show\": _cache[6] || (_cache[6] = ($event: any) => ((showFlowsEditor).value = $event)),\n      width: windowWidth.value,\n      placement: 'left'\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_unref(NDrawerContent), null, {\n          default: _withCtx(() => [\n            _createElementVNode(\"div\", _hoisted_2, [\n              _createVNode(_unref(NFlex), {\n                class: \"noscroll\",\n                style: {\"flex-grow\":\"1\",\"overflow-y\":\"scroll\"}\n              }, {\n                default: _withCtx(() => [\n                  (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(appState.value.flows.length, (i, flow) => {\n                    return (_openBlock(), _createBlock(MessageFlow, {\n                      key: flow,\n                      label: _unref(text).flowLabel[flow],\n                      \"onUpdate:label\": ($event: any) => ((_unref(text).flowLabel[flow]) = $event),\n                      source: appState.value.flows[flow],\n                      \"onUpdate:source\": ($event: any) => ((appState.value.flows[flow]) = $event),\n                      flow: flow\n                    }, null, 8, [\"label\", \"onUpdate:label\", \"source\", \"onUpdate:source\", \"flow\"]))\n                  }), 128)),\n                  _createVNode(_unref(NCard), { class: \"flowControl\" }, {\n                    default: _withCtx(() => [\n                      _createVNode(_unref(NFlex), { vertical: \"\" }, {\n                        default: _withCtx(() => [\n                          _createVNode(_unref(NButton), {\n                            onClick: _cache[3] || (_cache[3] = ($event: any) => (appState.value.flows.push([])))\n                          }, {\n                            default: _withCtx(() => [...(_cache[19] || (_cache[19] = [\n                              _createTextVNode(\"添加\", -1)\n                            ]))]),\n                            _: 1\n                          }),\n                          _createVNode(_unref(NButton), {\n                            onClick: _cache[4] || (_cache[4] = ($event: any) => (appState.value.flows.pop())),\n                            disabled: appState.value.flows.length<=1\n                          }, {\n                            default: _withCtx(() => [...(_cache[20] || (_cache[20] = [\n                              _createTextVNode(\"移除\", -1)\n                            ]))]),\n                            _: 1\n                          }, 8, [\"disabled\"])\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              }),\n              _cache[21] || (_cache[21] = _createElementVNode(\"div\", { style: {\"border-top\":\"1px solid gainsboro\",\"height\":\"8px\"} }, null, -1)),\n              _createVNode(_unref(NPageHeader), {\n                subtitle: \"推送流\",\n                onBack: _cache[5] || (_cache[5] = ($event: any) => (showFlowsEditor.value=false))\n              })\n            ])\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"show\", \"width\"]),\n    _createVNode(_unref(NDrawer), {\n      class: \"user-editor-container\",\n      show: showUserEditor.value,\n      \"onUpdate:show\": _cache[10] || (_cache[10] = ($event: any) => ((showUserEditor).value = $event)),\n      width: windowWidth.value>500?500:windowWidth.value,\n      onUpdateShow: _cache[11] || (_cache[11] = (show)=>{if(!show){\n            _unref(progress).userFlowTags[appState.value.editingUser]=editingFlowTags.value.map(label=>_unref(text).flowLabel.indexOf(label)).filter(flow=>flow>0);\n            console.log(_unref(progress).userFlowTags[appState.value.editingUser]);\n            appState.value.editingUser=-1;\n        }})\n    }, {\n      default: _withCtx(() => [\n        _createVNode(_unref(NDrawerContent), { \"native-scrollbar\": false }, {\n          header: _withCtx(() => [\n            _createVNode(_unref(NPageHeader), {\n              subtitle: \"用户分析\",\n              onBack: _cache[7] || (_cache[7] = ($event: any) => (showUserEditor.value=false))\n            }),\n            _createElementVNode(\"h1\", null, \"#\" + _toDisplayString(_unref(getUserName)(appState.value.editingUser)), 1)\n          ]),\n          default: _withCtx(() => [\n            _createElementVNode(\"p\", null, [\n              _createVNode(_unref(NDynamicTags), {\n                value: editingFlowTags.value,\n                \"onUpdate:value\": _cache[9] || (_cache[9] = ($event: any) => ((editingFlowTags).value = $event)),\n                onCreate: onCreateFlowTag\n              }, {\n                input: _withCtx(({ submit, deactivate }) => [\n                  _createVNode(_unref(NAutoComplete), {\n                    ref_key: \"autoCompleteInstRef\",\n                    ref: autoCompleteInstRef,\n                    value: flowTagInputValue.value,\n                    \"onUpdate:value\": _cache[8] || (_cache[8] = ($event: any) => ((flowTagInputValue).value = $event)),\n                    size: \"small\",\n                    options: flowTagOptions.value,\n                    placeholder: \"添加订阅\",\n                    \"clear-after-select\": true,\n                    onSelect: ($event: any) => (submit($event)),\n                    onBlur: deactivate\n                  }, null, 8, [\"value\", \"options\", \"onSelect\", \"onBlur\"])\n                ]),\n                _: 1\n              }, 8, [\"value\"])\n            ]),\n            _createVNode(_unref(NTabs), {\n              class: \"user-editor\",\n              type: \"segment\",\n              animated: \"\"\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_unref(NTabPane), {\n                  name: \"new\",\n                  tab: \"最新发言\"\n                }, {\n                  default: _withCtx(() => [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList((appState.value.uncollectedMessages[appState.value.editingUser]), (msgId) => {\n                      return (_openBlock(), _createBlock(MessageCard, {\n                        msg: _unref(progress).messages[msgId],\n                        key: msgId\n                      }, {\n                        action: _withCtx(() => [\n                          _createVNode(_unref(NFlex), { justify: \"space-between\" }, {\n                            default: _withCtx(() => [\n                              _createVNode(_unref(NButton), {\n                                onClick: ($event: any) => (collectMsg(_unref(progress).messages[msgId]))\n                              }, {\n                                default: _withCtx(() => [...(_cache[22] || (_cache[22] = [\n                                  _createTextVNode(\"收集\", -1)\n                                ]))]),\n                                _: 1\n                              }, 8, [\"onClick\"]),\n                              _createVNode(_unref(NButton), {\n                                onClick: ($event: any) => (forgetMsg(_unref(progress).messages[msgId]))\n                              }, {\n                                default: _withCtx(() => [...(_cache[23] || (_cache[23] = [\n                                  _createTextVNode(\"忽略\", -1)\n                                ]))]),\n                                _: 1\n                              }, 8, [\"onClick\"])\n                            ]),\n                            _: 2\n                          }, 1024)\n                        ]),\n                        _: 2\n                      }, 1032, [\"msg\"]))\n                    }), 128))\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_unref(NTabPane), {\n                  name: \"history\",\n                  tab: \"历史发言\"\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(MessageList, {\n                      source: getUserMessages(appState.value.editingUser),\n                      filter: (msg)=>true,\n                      select: false\n                    }, null, 8, [\"source\"])\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"show\", \"width\"]),\n    _createElementVNode(\"div\", _hoisted_3, [\n      _createElementVNode(\"div\", _hoisted_4, [\n        _createVNode(_unref(NButton), {\n          round: \"\",\n          type: \"primary\",\n          size: \"large\",\n          onClick: _cache[12] || (_cache[12] = ($event: any) => (showFlowsEditor.value=true))\n        }, {\n          default: _withCtx(() => [...(_cache[24] || (_cache[24] = [\n            _createTextVNode(\"编辑推送流\", -1)\n          ]))]),\n          _: 1\n        })\n      ]),\n      _createElementVNode(\"div\", _hoisted_5, [\n        _createVNode(_unref(NIcon), null, {\n          default: _withCtx(() => [\n            _createVNode(_unref(Time))\n          ]),\n          _: 1\n        }),\n        _createTextVNode(\" \" + _toDisplayString(gameTime.value) + \" \", 1),\n        _createVNode(_unref(NIcon), null, {\n          default: _withCtx(() => [\n            _createVNode(_unref(Network1))\n          ]),\n          _: 1\n        }),\n        _cache[25] || (_cache[25] = _createTextVNode()),\n        _createVNode(_unref(NNumberAnimation), { to: gameScore.value }, null, 8, [\"to\"])\n      ]),\n      _createElementVNode(\"div\", _hoisted_6, [\n        _createVNode(_unref(NButton), {\n          round: \"\",\n          type: \"primary\",\n          size: \"large\",\n          onClick: finishRound\n        }, {\n          default: _withCtx(() => [...(_cache[26] || (_cache[26] = [\n            _createTextVNode(\"结束回合\", -1)\n          ]))]),\n          _: 1\n        })\n      ])\n    ]),\n    _createVNode(_unref(NModal), {\n      show: gameEnded.value,\n      \"onUpdate:show\": _cache[14] || (_cache[14] = ($event: any) => ((gameEnded).value = $event)),\n      preset: \"card\",\n      style: {\"width\":\"600px\"},\n      title: `游戏结束`,\n      size: \"huge\",\n      bordered: false,\n      \"mask-closable\": false\n    }, {\n      default: _withCtx(() => [\n        _createElementVNode(\"p\", null, [\n          _cache[27] || (_cache[27] = _createTextVNode(\"你的网络在第\", -1)),\n          _createElementVNode(\"b\", null, _toDisplayString(gameTime.value), 1),\n          _cache[28] || (_cache[28] = _createTextVNode(\"回合安静下来了，你的得分是\", -1)),\n          _createElementVNode(\"b\", null, _toDisplayString(gameScore.value), 1),\n          _cache[29] || (_cache[29] = _createTextVNode(\"。\", -1))\n        ]),\n        _createVNode(_component_center, null, {\n          default: _withCtx(() => [\n            _createVNode(_unref(NButton), {\n              onClick: _cache[13] || (_cache[13] = ($event: any) => {gameEnded.value=false;_unref(resetProgress)()})\n            }, {\n              default: _withCtx(() => [...(_cache[30] || (_cache[30] = [\n                _createTextVNode(\"重新开始\", -1)\n              ]))]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }, 8, [\"show\"])\n  ]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport { computed, nextTick, onMounted, Ref, ref, watch } from 'vue';\nimport GameCanvas from './components/GameCanvas.vue';\nimport MessageCard from './components/MessageCard.vue';\nimport MessageList from './components/MessageList.vue';\nimport { createUser, Message, progress, processPushTask, getSubjectUserGraph, rSetIn, updateUsers, setProgress, resetProgress } from './game';\nimport { subscribe } from './event';\nimport { NPageHeader, NTabs, NTabPane, NDrawer, NDrawerContent, NButton, NFlex, NDynamicTags, AutoCompleteInst, NAutoComplete, NCard, NModal, NIcon, NRow, NCol, NNumberAnimation, NStatistic, NDivider } from 'naive-ui';\nimport { getUserName, loadText, processGenerateQueue, resetText, text } from './text';\nimport { startGenerateMessage } from './text';\nimport MessageFlow from './components/MessageFlow.vue';\nimport { View, ThumbsUp, AnalyticsReference, AiResultsHigh, Time, Network1 } from '@vicons/carbon'\n\nonMounted(()=>{\n    // const progressSource = localStorage.getItem('progress');\n    // if (progressSource != null)\n    // {\n    //     setProgress(JSON.parse(progressSource));\n    //     gameScore.value = progress.score;\n    //     gameTime.value = progress.time;\n    // }\n    // else\n    // {\n        \n    // }\n    // const appstateSource = localStorage.getItem('appstate');\n    // if (appstateSource != null)\n    // {\n    //     appState.value = JSON.parse(appstateSource);\n    // }\n    // loadText();\n    window.addEventListener('beforeunload', ()=>{\n        localStorage.setItem('appstate', JSON.stringify(appState.value))\n        localStorage.setItem('progress', JSON.stringify(progress));\n    });\n    gameInit();\n});\n\nexport interface AppState {\n    mode: \"user-edit\" | \"connect\" | \"disconnect\";\n    editingUser: number;\n    uncollectedMessages: Record<number,Array<number>>;\n    flows: Array<Array<number>>;\n    messageStatistic: Array<{msg:number,views:number,likes:number,exposure:number,score:number}>;\n}\n\nconst appState:Ref<AppState> = ref({\n    mode:'user-edit',\n    editingUser:-1,\n    uncollectedMessages:{},\n    flows:[[]],\n    messageStatistic:[]\n});\n\nconst showUserEditor = ref(false);\nconst showFlowsEditor = ref(false);\n\nconst messages = ref(progress.messages);\nfunction getUserMessages(author:number)\n{\n    return messages.value.filter(m=>m.i==author);\n}\n\nconst editingFlowTags:Ref<Array<string>> = ref([]);\nfunction onCreateFlowTag(tag:string):string\n{\n    if (editingFlowTags.value.includes(tag))return \"\";\n    const flow = text.flowLabel.indexOf(tag);\n    if (flow==undefined) return \"\";\n    if (flow<=0) return \"\";\n    return tag;\n}\nconst autoCompleteInstRef = ref<AutoCompleteInst | null>(null)\nwatch(autoCompleteInstRef, (value) => {\n  if (value)\n    nextTick(() => value.focus())\n})\nconst flowTagInputValue = ref('');\nconst flowTagOptions = computed(() => {\n  if (flowTagInputValue.value === null) {\n    return []\n  }\n  return text.flowLabel.filter(label=>!editingFlowTags.value.includes(label)&&label.includes(flowTagInputValue.value)).map((completion) => {\n    return {\n      label: completion,\n      value: completion\n    }\n  })\n})\nsubscribe('userPressed', (id)=>\n{\n    if (progress.userType[id]==0)\n    {\n        if (appState.value.mode==\"user-edit\")\n        {\n            showUserEditor.value = true;\n            appState.value.editingUser = id;\n            while (progress.userFlowTags.length <= id)\n            {\n                progress.userFlowTags.push([]);\n            }\n            editingFlowTags.value = progress.userFlowTags[id].map(flow=>text.flowLabel[flow]);\n        }\n    }\n})\n\nsubscribe('addedMessage', (msg:Message)=>{\n    if (!(msg.a in appState.value.uncollectedMessages))\n    {\n        appState.value.uncollectedMessages[msg.a] = [];\n    }\n    appState.value.uncollectedMessages[msg.a].push(msg.id);\n});\n\nfunction forgetMsg(msg:Message)\n{\n    appState.value.uncollectedMessages[msg.a] = appState.value.uncollectedMessages[msg.a].filter(m=>m!=msg.id);\n}\nfunction collectMsg(msg:Message)\n{\n    forgetMsg(msg);\n    appState.value.flows[0].push(msg.id);\n}\nfunction finishRound()\n{\n    progress.time += 1;\n    gameTime.value = progress.time;\n    appState.value.uncollectedMessages = {};\n    for(let flow=0;flow<appState.value.flows.length;flow++)\n    {\n        processPushTask(appState.value.flows[flow],flow);\n        appState.value.flows[flow] = [];\n    }\n    updateUsers();\n    if (Object.keys (appState.value.uncollectedMessages).length==0)\n    {\n        gameEnded.value = true;\n    }\n    else if (appState.value.messageStatistic.length>0)\n    {\n        appState.value.messageStatistic = appState.value.messageStatistic.sort((s1,s2)=>s2.exposure-s1.exposure);\n        showStatistic.value = true;\n    }\n}\nsubscribe('addedMessage', (msg:Message)=>startGenerateMessage(msg));\nsetInterval(() => {\n    processGenerateQueue();\n}, 1000);\nsetInterval(() => {\n    windowWidth.value = window.innerWidth;\n}, 1);\nconst windowWidth = ref(0);\nfunction checkoutMessageStatistic(msgId:number)\n{\n    for (let i=0;i<appState.value.messageStatistic.length;i++)\n    {\n        if (appState.value.messageStatistic[i].msg == msgId) return i;\n    }\n    appState.value.messageStatistic.push({msg:msgId,views:0,likes:0,exposure:0,score:0});\n    return appState.value.messageStatistic.length-1;\n}\nsubscribe('viewedMessage',(msgId,view)=>{\n    appState.value.messageStatistic[checkoutMessageStatistic(msgId)].views = view;\n})\nsubscribe('likedMessage',(msgId,like)=>{\n    appState.value.messageStatistic[checkoutMessageStatistic(msgId)].likes = like;\n})\nsubscribe('messageKnownExposure',(msgId,exposure)=>{\n    appState.value.messageStatistic[checkoutMessageStatistic(msgId)].exposure = exposure;\n})\nsubscribe('messageGainedScore',(msgId,score)=>{\n    appState.value.messageStatistic[checkoutMessageStatistic(msgId)].score = score;\n    progress.score += score;\n    gameScore.value = progress.score;\n    roundScore += score;\n})\nconst showStatistic = ref(false);\nlet roundScore = 0;\nconst gameScore = ref(0);\nconst gameTime = ref(0);\nconst gameEnded = ref(false);\nsubscribe('resetProgress', ()=>{\n    appState.value={\n        mode:'user-edit',\n        editingUser:-1,\n        uncollectedMessages:{},\n        flows:[[]],\n        messageStatistic:[]\n    };\n    gameTime.value = 0;\n    gameScore.value = 0;\n    resetText();\n    gameInit();\n});\nfunction gameInit()\n{\n    createUser(0);\n    createUser(0);\n    createUser(0);\n    createUser(0);\n    for(let p=0;p<progress.userCount;p++)\n    {\n        const G = getSubjectUserGraph(p);\n        // for(let x=0;x<4;x++)\n        // {\n        //     for(let o=0;o<4;o++)\n        //     {\n        //         rSetIn(x,o,1,G);\n        //     }\n        // }\n        for(let x=0;x<4;x++)\n        {\n            rSetIn(p,x,(Math.random()*2-1)*2,G);\n        }\n    }\n    text.userTexts.push(\n        {\n            name: \"A\",\n            prompt: \"\"\n        },\n        {\n            name: \"B\",\n            prompt: \"\"\n        },\n        {\n            name: \"C\",\n            prompt: \"\"\n        },\n        {\n            name: \"D\",\n            prompt: \"\"\n        }\n    );\n    finishRound();\n}\n</script>\n\n<template>\n<div class=\"app\">\n    <!-- <p v-for=\"flow,flowId in appState.flows\" :key=\"flowId\">{{ flowId }}</p> -->\n    <GameCanvas v-model=\"appState\" ref=\"canvas\"/>\n    <n-modal v-model:show=\"showStatistic\" preset=\"card\" style=\"width: 600px;\" :title=\"`第${progress.time}回合统计`\" size=\"huge\" :bordered=\"false\"\n        @update-show=\"(show)=>{if(!show){appState.messageStatistic=[];roundScore=0;}}\"\n    >\n        <center>\n            <h3>总得分</h3>\n            <h1><n-number-animation :to=\"Math.floor(roundScore)\"/></h1>\n        </center>\n        <MessageCard v-for=\"statistic in appState.messageStatistic\" :key=statistic.msg :msg=\"progress.messages[statistic.msg]\">\n            <template #suffix>\n                <n-row>\n                    <n-col :span=\"12\">\n                        <n-statistic label=\"浏览\" :value=\"statistic.views.toFixed(3)\">\n                            <template #prefix><n-icon><View/></n-icon></template>\n                            <template #suffix>K</template>\n                        </n-statistic>\n                    </n-col>\n                    <n-col :span=\"12\">\n                        <n-statistic label=\"点赞\" :value=\"(statistic.likes*(Math.abs(Math.random()-0.8)+0.8)).toFixed(3)\">\n                            <template #prefix><n-icon><ThumbsUp/></n-icon></template>\n                            <template #suffix>K</template>\n                        </n-statistic>\n                    </n-col>\n                    <n-col :span=\"12\">\n                        <n-statistic label=\"曝光倍率\" :value=\"statistic.exposure\">\n                            <template #prefix><n-icon><AnalyticsReference/></n-icon></template>\n                            <template #suffix>x</template>\n                        </n-statistic>\n                    </n-col>\n                    <n-col :span=\"12\">\n                        <n-statistic label=\"得分\" :value=\"statistic.score.toFixed()\">\n                            <template #prefix><n-icon><AiResultsHigh/></n-icon></template>\n                        </n-statistic>\n                    </n-col>\n                </n-row>\n            </template>\n        </MessageCard>\n    </n-modal>\n    <n-drawer v-model:show=\"showFlowsEditor\" :width=\"windowWidth\" :placement=\"'left'\">\n        <n-drawer-content>\n            <div class=\"flows\">\n                <n-flex class=\"noscroll\" style=\"flex-grow: 1;overflow-y:scroll;\">\n                    <MessageFlow v-for=\"i,flow in appState.flows.length\" :key=\"flow\" v-model:label=\"text.flowLabel[flow]\" v-model:source=\"appState.flows[flow]\" :flow=\"flow\"/>\n                    <NCard class=\"flowControl\">\n                        <n-flex vertical>\n                            <n-button @click=\"appState.flows.push([])\">添加</n-button>\n                            <n-button @click=\"appState.flows.pop()\" :disabled=\"appState.flows.length<=1\">移除</n-button>\n                        </n-flex>\n                    </NCard>\n                </n-flex>\n                <div style=\"border-top: 1px solid gainsboro; height: 8px;\"></div>\n                <n-page-header subtitle=\"推送流\" @back=\"showFlowsEditor=false\"></n-page-header>\n            </div>\n        </n-drawer-content>\n    </n-drawer>\n        <n-drawer class=\"user-editor-container\" v-model:show=\"showUserEditor\" :width=\"windowWidth>500?500:windowWidth\" @update-show=\"(show)=>{if(!show){\n            progress.userFlowTags[appState.editingUser]=editingFlowTags.map(label=>text.flowLabel.indexOf(label)).filter(flow=>flow>0);\n            console.log(progress.userFlowTags[appState.editingUser]);\n            appState.editingUser=-1;\n        }}\">\n            <n-drawer-content :native-scrollbar=\"false\">\n                <template #header>\n                    <n-page-header subtitle=\"用户分析\" @back=\"showUserEditor=false\"></n-page-header>\n                    <h1>#{{ getUserName(appState.editingUser) }}</h1>\n                </template>\n                <p>\n                <n-dynamic-tags v-model:value=\"editingFlowTags\" @create=onCreateFlowTag>\n                    <template #input=\"{ submit, deactivate }\">\n                    <n-auto-complete\n                        ref=\"autoCompleteInstRef\"\n                        v-model:value=\"flowTagInputValue\"\n                        size=\"small\"\n                        :options=\"flowTagOptions\"\n                        placeholder=\"添加订阅\"\n                        :clear-after-select=\"true\"\n                        @select=\"submit($event)\"\n                        @blur=\"deactivate\"\n                    />\n                    </template>\n                </n-dynamic-tags>\n                </p>\n                <n-tabs class=\"user-editor\" type=\"segment\" animated>\n                    <n-tab-pane name=\"new\" tab=\"最新发言\">\n                        <MessageCard :msg=\"progress.messages[msgId]\" v-for=\"msgId in (appState.uncollectedMessages[appState.editingUser])\" :key=\"msgId\">\n                            <template #action>\n                                <n-flex justify=\"space-between\">\n                                    <n-button @click=\"collectMsg(progress.messages[msgId])\">收集</n-button>\n                                    <n-button @click=\"forgetMsg(progress.messages[msgId])\">忽略</n-button>\n                                </n-flex>\n                            </template>\n                        </MessageCard>\n                    </n-tab-pane>\n                    <n-tab-pane name=\"history\" tab=\"历史发言\">\n                        <MessageList :source=\"getUserMessages(appState.editingUser)\" :filter=\"(msg)=>true\" :select=\"false\"/>\n                    </n-tab-pane>\n                </n-tabs>\n            </n-drawer-content>\n        </n-drawer>\n        <div class=\"pagebottom\">\n            <div class=\"buttons\">\n                <n-button round type=\"primary\" size=\"large\" @click=\"showFlowsEditor=true\">编辑推送流</n-button>\n            </div>\n            <div class=\"score\">\n                <n-icon><Time/></n-icon> {{ gameTime }} <n-icon><Network1/></n-icon> <n-number-animation :to=\"gameScore\"/>\n            </div>\n            <div class=\"buttons\">\n                <n-button round type=\"primary\" size=\"large\" @click=\"finishRound\">结束回合</n-button>\n            </div>\n        </div>\n        <n-modal v-model:show=\"gameEnded\" preset=\"card\" style=\"width: 600px;\" :title=\"`游戏结束`\" size=\"huge\" :bordered=\"false\" :mask-closable=false>\n            <p>你的网络在第<b>{{ gameTime }}</b>回合安静下来了，你的得分是<b>{{ gameScore }}</b>。</p>\n            <center><n-button @click=\"gameEnded=false;resetProgress()\">重新开始</n-button></center>\n        </n-modal>\n</div>\n</template>\n\n<style>\nbody\n{\n    margin: 0;\n    overflow: hidden;\n}\n\n.app\n{\n    display: flex;\n    width: 100vw;\n    height: 100vh;\n}\n.buttons\n{\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n@media (max-width: 500px) {\n    .user-editor-container {\n        width: 400px;\n    }\n}\n.flows\n{\n    overflow: hidden;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n}\n.noscroll::-webkit-scrollbar {\n    display: none;\n}\n.flow\n{\n    overflow-y: scroll;\n    width: 300px;\n    height: 100%;\n    margin: 8px;\n    box-shadow: 0 0 5px 0px rgba(0,0,0,0.5);\n}\n.flow::-webkit-scrollbar {\n    display: none;\n}\n.flowControl\n{\n    width: 300px;\n    margin: 8px;\n    height: min-content;\n    display: flex;\n    flex-direction: column;\n}\n.pagebottom\n{\n    display:flex;\n    position:absolute;\n    height:40px;\n    justify-content:space-between;\n    bottom:20px;\n    left:20px;\n    right:20px;\n}\n.score\n{\n    background: white;\n    box-shadow: 0 0 5px rgba(0,0,0,0.5);\n    border-radius: 8px;\n    color:black;\n    padding: 8px;\n    text-wrap-mode: nowrap;\n    text-align: center;\n    font-weight: bold;\n}\n</style>","import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=4608d502&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkvue_project\"] = self[\"webpackChunkvue_project\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(9688); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["events","subscribe","event","action","key","Object","keys","length","emit","args","values","forEach","debugMode","progress","userMemory","subjectiveUserGraph","messages","userType","userLearnRate","userCount","userFlowTags","time","score","resetProgress","getSubjectUserGraph","user","rGetIn","a","b","graph","k","toString","rSetIn","v","processPushTask","tasks","flow","flowTags","undefined","includes","i","pushMsgToUser","createMessage","j","msg","id","t","push","changeAttitude","d","value","Math","abs","updateUser","console","log","maxIPD","maxIPD_o","maxIPD_x","G","o","x","IPD","instabilityPartialD","dAttitude","atan","instability","p","s","Gpx","Gpo","Gox","GooSub","exposure","oldInstability","ox","lambda","newInstability","views","likes","random","floor","updateUsers","getRepulsion","rij","repulsion","innerRepulsion","outterRepulsion","createUser","type","learnRate","OpenAI","apiKey","baseURL","dangerouslyAllowBrowser","delay","ms","Promise","resolve","setTimeout","async","chat","text","userTexts","messageTexts","generateQueue","flowLabel","resetText","getUserName","name","getMessageMinimumVersionPrompt","content","generating","processGenerateQueue","title","minimumVersion","msgObj","describe","localStorage","setItem","JSON","stringify","shift","startGenerateMessage","_hoisted_1","class","_defineComponent","__name","props","y","selected","Boolean","focused","px","py","ps","badgeDefault","badgeInfo","setup","__props","onClick","_ctx","_cache","_openBlock","_createElementBlock","style","_normalizeStyle","left","top","outline","_unref","_createVNode","NBadge","offset","default","_withCtx","_createElementVNode","_toDisplayString","_","__exports__","idealDist","delta","stepLength","emits","state","ref","users","selectedUsers","focusedUser","appState","_useModel","mode","filter","multiSelecting","multiSelectStartX","multiSelectStartY","mouseX","mouseY","touchStartX","touchStartY","touchStartCanvasX","touchStartCanvasY","touchesDistance","onTouchStart","e","preventDefault","touches","touch","clientX","clientY","onTouchEnd","onTouchMove","x1","y1","x2","y2","sqrt","changeScale","onMousemove","buttons","movementX","movementY","onMousedown","bgDownButtons","linesCanvas","linesCtx","onMouseup","ux","uy","newSelecteState","shiftKey","map","mx","my","s1","mx1","my1","s2","mx2","my2","onWheel","wheelDelta","getForce","ax","ay","bx","by","idealDistScale","strengthScale","dx","dy","ls","l","tl","f","physicsProcess","vx","vy","redraw","width","window","innerWidth","height","innerHeight","editingUser","entries","r","splited","split","fromId","parseInt","toId","from","to","strokeStyle","font","fillText","toFixed","padStart","beginPath","moveTo","lineTo","stroke","fromIdStr","rFT","keyFrom","aFT","styleFT","rTF","aTF","styleTF","grd","createLinearGradient","addColorStop","w","h","rect","fillStyle","fill","onMounted","document","getElementById","getContext","setInterval","pop","onTouchstart","onTouchend","onTouchmove","_Fragment","_renderList","_createBlock","CanvasUser","uncollectedMessages","_hoisted_2","_hoisted_3","messageText","NCard","hoverable","header","NSkeleton","round","NEllipsis","_createTextVNode","_renderSlot","$slots","repeat","_mergeModels","source","Function","select","checkedRowKeys","createColumns","columns","multiple","disabled","row","NDataTable","$event","data","pagination","bordered","striped","label","_component_center","_resolveComponent","NTag","NInput","size","placeholder","draggable","modelValue","animation","group","item","element","MessageCard","index","_hoisted_4","_hoisted_5","_hoisted_6","addEventListener","gameInit","flows","messageStatistic","showUserEditor","showFlowsEditor","getUserMessages","author","m","editingFlowTags","onCreateFlowTag","tag","indexOf","autoCompleteInstRef","watch","nextTick","focus","flowTagInputValue","flowTagOptions","computed","completion","forgetMsg","collectMsg","finishRound","gameTime","gameEnded","sort","showStatistic","windowWidth","checkoutMessageStatistic","msgId","view","like","gameScore","roundScore","prompt","GameCanvas","NModal","show","preset","onUpdateShow","_isRef","NNumberAnimation","statistic","suffix","NRow","NCol","span","NStatistic","prefix","NIcon","View","ThumbsUp","AnalyticsReference","AiResultsHigh","NDrawer","placement","NDrawerContent","NFlex","MessageFlow","vertical","NButton","NPageHeader","subtitle","onBack","NDynamicTags","onCreate","input","submit","deactivate","NAutoComplete","ref_key","options","onSelect","onBlur","NTabs","animated","NTabPane","tab","justify","MessageList","Time","Network1","createApp","App","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","deferred","O","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","every","splice","n","getter","__esModule","definition","defineProperty","enumerable","get","g","globalThis","this","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","bind","__webpack_exports__"],"ignoreList":[],"sourceRoot":""}